<! DOCTYPE html>
<html>
	<head>
		<base href="../">
		<title>ksgwxfan - Matching Game</title>
		<style>
			.HEADER {
				width: 100%;
				font-weight: bold;
				font-size: 30px;
				display: inline-block;
				}
			.HEADERPHOTO {
				width: 3%;
				border: 2px solid white;
				box-shadow: 0px 0px 5px white;
				border-radius: 35%;
				display: inline-block;
				}
			.OPTIONSCREEN {
				display: table-cell;
				vertical-align: middle;
				color: black;
				font-weight: bold;
				font-size: 2em;
				padding-left: 5%;
				padding-right: 5%;
				background-color: rgba(255,255,255,80%);
				text-align: center;"
				-webkit-user-select: none; /* Safari 3.1+ */
				-moz-user-select: none; /* Firefox 2+ */
				-ms-user-select: none; /* IE 10+ */
				user-select: none; /* Standard syntax */
			}
			.END {
				display: none;
			}
			.BOARD {
				--bwidth: 40vmax;
				position: relative;
				background: repeating-linear-gradient(to top right, lightblue 0% 2%, white 2.1% 4%, yellow 4.1% 6%, white 6.1% 8%);
				margin: auto;
				width: var(--bwidth);
				height: var(--bwidth);
				min-width: 350px;
				min-height: 350px;
				max-width: 1000px;
				max-height: 1000px;
				border: 2px solid white;
			}
			.CARDBACK {
				position: absolute;
				background: red;
				background-image: repeating-linear-gradient(to top right, rgba(255,255,255,60%) 5%, rgba(255,255,255,0%) 6% 8%, rgba(255,255,255,60%) 10%),
								  repeating-linear-gradient(to top left, rgba(255,255,255,60%) 5%, rgba(255,255,255,0%) 6% 8%, rgba(255,255,255,60%) 10%);
				border: 3px solid white;
				width: 21%;
				height: 21%;
				transform: translate(-50%,-50%);
			}
			.CLIPART {
				position: absolute;
				border: 3px solid black;
				background-color: rgba(255,255,255,90%);
				text-align: center;
				font-size: 4em;
				color: black;
				width: 21%;
				height: 21%;
				transform: translate(-50%,-50%);
				-webkit-user-select: none; /* Safari 3.1+ */
				-moz-user-select: none; /* Firefox 2+ */
				-ms-user-select: none; /* IE 10+ */
				user-select: none; /* Standard syntax */
			}
			.WRONGGUESS {
				--clear: rgba(255,255,255,.01%);
				--red: rgba(255,0,0,50%);
				display:none;
				position:absolute;
				top:0%;
				left:0%;
				width:100%;
				height:100%;
				background:linear-gradient(to top right, var(--clear) 0% 48%, var(--red) 48% 52%, var(--clear) 52% 100%), 
				           linear-gradient(to top left, var(--clear) 0% 48%, var(--red) 48% 52%, var(--clear) 52% 100%);
			}
			.GOODGUESS {
				position:absolute;
				display: none;
				transform: translate(-50%,-50%);
				background: linear-gradient(to right, green 0% 2%, rgba(255,255,255,0) 2%),
							linear-gradient(to top, green 0% 2%, rgba(255,255,255,0) 2%),
							linear-gradient(to left, green 0% 2%, rgba(255,255,255,0) 2%),
							linear-gradient(to bottom, green 0% 2%, rgba(255,255,255,0) 2%);
				top:50%;
				left:50%;
				width:99%;
				height:99%;
			}
			.tableframe {
				display:table;
				border-collapse: collapse;
				width:560px;
				height:30px;
				margin:auto;
				font-family: Arial, Helvetica, sans-serif;
			}
			.col {
				border: 1px solid gray;
				display: table-cell;
				text-align: center;
				vertical-align: middle;
				user-select: none;
			}
			.row {
				display: table-row;
			}
		</style>
	</head>
	<body style="background-color:#141414;color:white;" link="lightBlue" vlink="lightBlue">
		<div class="HEADER">
			<img class="HEADERPHOTO" src="profile.png"> <u>Matching Game</u>
		</div><br><br>
		<div id="container" class="BOARD">
			<!-- CLIPART IMAGES -->
			<div id="p01" class="CLIPART" style="top:12.5%;left:12.5%;"> </div>
			<div id="p02" class="CLIPART" style="top:12.5%;left:37.5%;"> </div>
			<div id="p03" class="CLIPART" style="top:12.5%;left:62.5%;"> </div>
			<div id="p04" class="CLIPART" style="top:12.5%;left:87.5%;"> </div>
			<div id="p05" class="CLIPART" style="top:37.5%;left:12.5%;"> </div>
			<div id="p06" class="CLIPART" style="top:37.5%;left:37.5%;"> </div>
			<div id="p07" class="CLIPART" style="top:37.5%;left:62.5%;"> </div>
			<div id="p08" class="CLIPART" style="top:37.5%;left:87.5%;"> </div>
			<div id="p09" class="CLIPART" style="top:62.5%;left:12.5%;"> </div>
			<div id="p10" class="CLIPART" style="top:62.5%;left:37.5%;"> </div>
			<div id="p11" class="CLIPART" style="top:62.5%;left:62.5%;"> </div>
			<div id="p12" class="CLIPART" style="top:62.5%;left:87.5%;"> </div>
			<div id="p13" class="CLIPART" style="top:87.5%;left:12.5%;"> </div>
			<div id="p14" class="CLIPART" style="top:87.5%;left:37.5%;"> </div>
			<div id="p15" class="CLIPART" style="top:87.5%;left:62.5%;"> </div>
			<div id="p16" class="CLIPART" style="top:87.5%;left:87.5%;"> </div>
			<!-- CARD BACKS -->
			<div id="c01" class="CARDBACK" style="top:12.5%;left:12.5%;" onClick="guess('01')"> </div>
			<div id="c02" class="CARDBACK" style="top:12.5%;left:37.5%;" onClick="guess('02')"> </div>
			<div id="c03" class="CARDBACK" style="top:12.5%;left:62.5%;" onClick="guess('03')"> </div>
			<div id="c04" class="CARDBACK" style="top:12.5%;left:87.5%;" onClick="guess('04')"> </div>
			<div id="c05" class="CARDBACK" style="top:37.5%;left:12.5%;" onClick="guess('05')"> </div>
			<div id="c06" class="CARDBACK" style="top:37.5%;left:37.5%;" onClick="guess('06')"> </div>
			<div id="c07" class="CARDBACK" style="top:37.5%;left:62.5%;" onClick="guess('07')"> </div>
			<div id="c08" class="CARDBACK" style="top:37.5%;left:87.5%;" onClick="guess('08')"> </div>
			<div id="c09" class="CARDBACK" style="top:62.5%;left:12.5%;" onClick="guess('09')"> </div>
			<div id="c10" class="CARDBACK" style="top:62.5%;left:37.5%;" onClick="guess('10')"> </div>
			<div id="c11" class="CARDBACK" style="top:62.5%;left:62.5%;" onClick="guess('11')"> </div>
			<div id="c12" class="CARDBACK" style="top:62.5%;left:87.5%;" onClick="guess('12')"> </div>
			<div id="c13" class="CARDBACK" style="top:87.5%;left:12.5%;" onClick="guess('13')"> </div>
			<div id="c14" class="CARDBACK" style="top:87.5%;left:37.5%;" onClick="guess('14')"> </div>
			<div id="c15" class="CARDBACK" style="top:87.5%;left:62.5%;" onClick="guess('15')"> </div>
			<div id="c16" class="CARDBACK" style="top:87.5%;left:87.5%;" onClick="guess('16')"> </div>
			<!-- GAME START -->
			<div id="optcontainer" style="display:table;position:absolute;top:0%;left:0%;width:100%;height:100%;">
				<div style="display:table-row;">
					<!-- GAME START -->
					<div id="begin" class="OPTIONSCREEN">
						WELCOME TO THE MATCHING GAME<br /><br />
						<font style="font-size:0.6em;">* Click on two cards to inquire if they match. Try solving in as few guesses as possible</font>
						<br /><br />
						<button onClick="gamenew()"><font style="font-size:2em;">NEW GAME</font></button>
						
					</div>
					<!-- GAME END -->
					<div id="end" class="OPTIONSCREEN END">
						GOOD JOB!<br /><br />
						You finished the puzzle in <span id="guesscount" style="color:green;font-size:1.5em;"> -- </span> guesses! Time: <span id="gameseconds" style="color:green;font-size:1.5em;"> -- </span> seconds!<br /><br />
						<button onClick="gamenew()"><font style="font-size:2em;">NEW GAME</font></button>
					</div>
				</div>
			</div>
			<!-- WRONG GUESS PLACEHOLDER -->
			<div id="miss" class="WRONGGUESS"> </div>
			<div id="correct" class="GOODGUESS"> </div>
		</div>
		<div id="bgoptions" class="tableframe" style="margin-top:40px;width:800px;">
			<div class="row">
				<div class="col" style="width:120px;">Background Pattern:</div>
				<div class="col" style="background:repeating-linear-gradient(to top right, lightblue 0% 20%, white 21% 40%, yellow 41% 60%, white 61% 80%)" onClick="changebgpattern(0)" title="lightblue-white-yellow (default)"></div>
				<div class="col" style="background:repeating-linear-gradient(to top right, black 0% 20%, white 21% 40%);" onClick="changebgpattern(1)" title="Black/White"></div>
				<div class="col" style="background:repeating-linear-gradient(to top right, MidnightBlue 0% 20%, CornflowerBlue 21% 40%, Navy 41% 60%, LightBlue 61% 80%);" onClick="changebgpattern(2)" title="Blues"></div>
				<div class="col" style="background:repeating-linear-gradient(to top right, red 0% 4%, orange 4.1% 8%, yellow 8.1% 12%, green 12.1% 16%, blue 16.1% 20%, indigo 20.1% 24%, violet 24.1% 28%, white 28.1% 32%);" onClick="changebgpattern(3)" title="Rainbow"></div>
				<div class="col" style="background:yellow radial-gradient(red 0% 40%, rgba(255,255,255,0) 40%) repeat -2% -2% / 20% 20%" onClick="changebgpattern(4)" title="Red/Yellow Polka-Dots"></div>
				<div class="col" style="background:darkgreen radial-gradient(lightblue 0% 40%, rgba(255,255,255,0) 40%) repeat -2% -2% / 20% 20%" onClick="changebgpattern(5)" title="Blue/Green Polka-Dots"></div>
			</div>
		</div>
		<div id="cardoptions" class="tableframe" style="margin-top:10px;width:800px;">
			<div class="row">
				<div class="col" style="width:120px;">Card-Back Color:</div>
				<div class="col" style="background-color:red;" onClick="changecardback('red')" title="Red (default)"></div>
				<div class="col" style="background-color:blue;" onClick="changecardback('blue')" title="Blue"></div>
				<div class="col" style="background-color:green;" onClick="changecardback('green')" title="Green"></div>
				<div class="col" style="background-color:yellow;" onClick="changecardback('yellow')" title="Yellow"></div>
				<div class="col" style="background-color:#ff6600;" onClick="changecardback('#ff6600')" title="Orange"></div>
				<div class="col" style="background-color:purple;" onClick="changecardback('purple')" title="Purple"></div>
				<div class="col" style="background-color:black;" onClick="changecardback('black')" title="Black"></div>
				<div class="col" style="background-color:teal;" onClick="changecardback('teal')" title="Teal"></div>
				<div class="col" style="background-color:#ff8095;" onClick="changecardback('#ff8095')" title="Pink"></div>
			</div>
		</div>
		
		<div id="description" style="width:80%;margin:auto;margin-top:20px;margin-bottom:10px;">
			Here's a seemingly simple matching game. Inspired by my niece. Enjoy. Feel free to inspect the code and use however you like. No attribution necessary.
		</div>
		
		<iframe src="footer.html" style="border:none;width:100%;height:40px;"></iframe>
		
	</body>
	<script>
	var timer;
	var good; 	// Will later be used as a timer interval to signify correct guesses
	var gamevars = {
		selected: 0,
		totalguesses: 0,
		matchquery: [],
		indicesassigned: [],
		totalmatches: 0
	};
	var timestart = new Date();
	//var timestartS;
	
	var imgarray = ["&#9728;",
					"&#9731;",
					"&starf;",
					"&#9743;",
					"&#9752;",
					"&#9813;",
					"&hearts;",
					"&#9992;"];
					
	function gamenew() {
		timestart = Date.now();
		document.getElementById("optcontainer").style.display = "none";
		gamevars.selected = 0;
		gamevars.totalguesses = 0;
		gamevars.matchquery = [];
		gamevars.indicesassigned = [];
		gamevars.totalmatches = 0;
		
		for (i=0;i<imgarray.length;i++) {
			for (j=0;j<2;j++) {
				do {
					r = Math.floor(Math.random() * 16) + 1;
					//console.log(r);
				} while (gamevars.indicesassigned.includes(r) == true);
				gamevars.indicesassigned.push(r);
				if (r < 10) {r = "0" + r;}
				//document.getElementById("p" + r).innerHTML = '<img src="' + imgarray[i] + '" style="width:100%;" />';
				document.getElementById("p" + r).innerHTML = imgarray[i];
				//console.log("p" + r + ", " + document.getElementById("p" + r).innerHTML);
			}
		}

		for (i=1;i<17;i++) {
			if (i < 10) {document.getElementById("c0" + i.toString()).style.display = "block";}
			else {document.getElementById("c" + i.toString()).style.display = "block";}
		}
		
	}
	
	function guess(pick) {
		gamevars.selected += 1;
		gamevars.matchquery.push(pick);
		document.getElementById("c" + pick).style.display = "none";
		if (gamevars.matchquery.length == 2) {
			matchcheck(gamevars.matchquery);
		}
	}
	
	function matchcheck(li_guesses) {
		//console.log(li_guesses);
		p1 = document.getElementById("p" + li_guesses[0]).innerHTML;
		p2 = document.getElementById("p" + li_guesses[1]).innerHTML;
		// IF MATCH IS FOUND
		if (p1 == p2) {
			//document.getElementById("message").innerHTML = "MATCH FOUND!";
			gamevars.totalmatches += 1;
			document.getElementById("correct").style.display = "block";
			document.getElementById("correct").style.opacity = "1";
			good = setInterval(right,50);
			if (gamevars.totalmatches == 8) {youwin();}
		}
		// IF MATCH IS WRONG
		else {
			//document.getElementById("message").innerHTML = "MISS!";
			document.getElementById("miss").style.display = "block";
			timer = setTimeout(function() {wrong(li_guesses)},3000);
		}
		gamevars.selected = 0;
		gamevars.matchquery = [];
		gamevars.totalguesses += 1;
	}
	
	function right() {
		var newopacity = eval(document.getElementById("correct").style.opacity);
		newopacity -= 0.05;
		document.getElementById("correct").style.opacity = newopacity.toString();
		if (eval(document.getElementById("correct").style.opacity) == 0) {
			clearInterval(good);
			document.getElementById("correct").style.display = "none";
		}
	}
	
	function wrong(missedguesses) {
		//console.log("TIMER FUNCTION ACTIVATED");
		document.getElementById("miss").style.display = "none";
		document.getElementById("c" + missedguesses[0]).style.display = "block";
		document.getElementById("c" + missedguesses[1]).style.display = "block";
	}
	
	function youwin() {
		document.getElementById("guesscount").innerHTML = gamevars.totalguesses;
		var timefinish = Date.now();
		var totalgametime = eval((timefinish - timestart) / 1000).toFixed(2);
		document.getElementById("gameseconds").innerHTML = totalgametime;
		document.getElementById("optcontainer").style.display = "table";
		document.getElementById("begin").style.display = "none";
		document.getElementById("end").style.display = "table-cell";
	}
	
	// HELPED: https://stackoverflow.com/questions/24682193/css-background-shorthand-property-not-working-with-background-size
	// HELPED: https://dev.to/clairecodes/how-to-create-a-polka-dot-background-with-css-23m0
	function changebgpattern(indexNum) {
		var patterncollection = [
								"repeating-linear-gradient(to top right, lightblue 0% 2%, white 2.1% 4%, yellow 4.1% 6%, white 6.1% 8%)",
								"repeating-linear-gradient(to top right, black 0% 2%, white 2.1% 4%)",
								"repeating-linear-gradient(to top right, MidnightBlue 0% 2%, CornflowerBlue 2.1% 4%, Navy 4.1% 6%, LightBlue 6.1% 8%)",
								"repeating-linear-gradient(to top right, red 0% 2%, orange 2.1% 4%, yellow 4.1% 6%, green 6.1% 8%, blue 8.1% 10%, indigo 10.1% 12%, violet 12.1% 14%, white 14.1% 16%)",
								"yellow radial-gradient(red 0% 40%, rgba(255,255,255,0) 40%) repeat -2% -2% / 8% 8%",
								"darkgreen radial-gradient(lightblue 0% 40%, rgba(255,255,255,0) 40%) repeat -2% -2% / 8% 8%"
								];
		
		document.getElementById("container").style.background = patterncollection[indexNum];
	}
	
	function changecardback(colorcode) {
		//console.log("changecardback function activated");
		for (x = 0; x<document.getElementsByClassName("CARDBACK").length; x++) {
			document.getElementsByClassName("CARDBACK")[x].style.backgroundColor = colorcode;
		}
	}
	
	
	
	</script>
</html>