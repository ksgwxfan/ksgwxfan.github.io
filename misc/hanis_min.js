var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(g,V,T){g!=Array.prototype&&g!=Object.prototype&&(g[V]=T.value)};$jscomp.getGlobal=function(g){return"undefined"!=typeof window&&window===g?g:"undefined"!=typeof global&&null!=global?global:g};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var g=0;return function(V){return $jscomp.SYMBOL_PREFIX+(V||"")+g++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var g=$jscomp.global.Symbol.iterator;g||(g=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[g]&&$jscomp.defineProperty(Array.prototype,g,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(g){var V=0;return $jscomp.iteratorPrototype(function(){return V<g.length?{done:!1,value:g[V++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(g){$jscomp.initSymbolIterator();g={next:g};g[$jscomp.global.Symbol.iterator]=function(){return this};return g};$jscomp.iteratorFromArray=function(g,V){$jscomp.initSymbolIterator();g instanceof String&&(g+="");var T=0,O={next:function(){if(T<g.length){var zb=T++;return{value:V(zb,g[zb]),done:!1}}O.next=function(){return{done:!0,value:void 0}};return O.next()}};O[Symbol.iterator]=function(){return O};return O};
$jscomp.polyfill=function(g,V,T,O){if(V){T=$jscomp.global;g=g.split(".");for(O=0;O<g.length-1;O++){var zb=g[O];zb in T||(T[zb]={});T=T[zb]}g=g[g.length-1];O=T[g];V=V(O);V!=O&&null!=V&&$jscomp.defineProperty(T,g,{configurable:!0,writable:!0,value:V})}};$jscomp.polyfill("Array.prototype.fill",function(g){return g?g:function(g,T,O){var V=this.length||0;0>T&&(T=Math.max(0,V+T));if(null==O||O>V)O=V;O=Number(O);0>O&&(O=Math.max(0,V+O));for(T=Number(T||0);T<O;T++)this[T]=g;return this}},"es6","es3");
function PEvs(g,V,T,O,zb,ye,Kd){var Ub,Ab,$a,cd,ha,Ld,ab,Ic,Md,Nd,Od,oc=0,Vb=0,pc,Bb=0,Jc=!1,qc=function(l){ab=l.target;for(Md=Ic=0;ab;)Ic+=ab.offsetLeft-ab.scrollLeft,Md+=ab.offsetTop-ab.scrollTop,ab=ab.offsetParent;oc=l.pageX-Ic-document.body.scrollLeft;Vb=l.pageY-Md-document.body.scrollTop};this.getX=function(){return oc};this.getY=function(){return Vb};var ea=function(l){qc(l);pc=oc;dd=Vb;Cb=!0;null!=Ja&&(cd=(new Date).getTime());null!=Ba&&Ba(l)},Pd=function(l){qc(l);Cb=!1;null!=qa&&qa(l);null!=
Ja&&(ha=(new Date).getTime(),Ld=ha-cd,300>Ld&&Ja(l))},H=function(l){qc(l);3>Math.abs(oc-pc)&&3>Math.abs(Vb-dd)||(dd=pc=-9999,Cb?null!=Sa&&Sa(l):null!=bb&&bb(l),null!=U&&cb())};this.touchDown=function(l){$a=!0;Bb+=l.changedTouches.length;if(1<Bb)return Jc=!0,l.returnValue=!0;Ub=l.changedTouches;Ab=Ub[0];ea(Ab)};this.touchUp=function(l){$a=!0;Bb-=l.changedTouches.length;0>Bb&&(Bb=0);0==Bb&&(Jc=!1);if(Jc)return l.returnValue=!0;l.preventDefault();l.stopImmediatePropagation?l.stopImmediatePropagation():
l.stopPropagation();Ub=l.changedTouches;Ab=Ub[0];Pd(Ab)};this.touchMove=function(l){$a=!0;if(Jc)return l.returnValue=!0;l.preventDefault();l.stopImmediatePropagation?l.stopImmediatePropagation():l.stopPropagation();Ub=l.changedTouches;Ab=Ub[0];H(Ab)};this.mouseDown=function(l){$a||(l.preventDefault(),l.stopImmediatePropagation?l.stopImmediatePropagation():l.stopPropagation(),ea(l))};this.clearDown=function(){Cb=!1};this.mouseUp=function(l){$a||(l.preventDefault(),l.stopImmediatePropagation?l.stopImmediatePropagation():
l.stopPropagation(),Pd(l))};this.useWheel=function(l){g.addEventListener("wheel",this.mouseWheel,!1);Od=l};this.mouseWheel=function(l){qc(l);var g=Math.max(-1,Math.min(1,-l.deltaY||-l.detail));l.preventDefault();l.stopImmediatePropagation?l.stopImmediatePropagation():l.stopPropagation();Od&&Od(g)};this.mouseClick=function(l){l.preventDefault();l.stopImmediatePropagation?l.stopImmediatePropagation():l.stopPropagation();Cb=!1};this.mouseMove=function(l){$a||(l.preventDefault(),l.stopImmediatePropagation?
l.stopImmediatePropagation():l.stopPropagation(),H(l))};this.mouseDragged=function(l){$a||(l.preventDefault(),l.stopImmediatePropagation?l.stopImmediatePropagation():l.stopPropagation(),qc(l),null!=Sa&&Sa(l),null!=U&&cb())};var cb=function(){clearTimeout(Nd);Nd=setTimeout(function(){U()},600)};var dd=pc=Vb=oc=0;var Ba=V;var qa=T;var bb=O;var Sa=zb;var Ja=ye;var U=Kd;var Cb=$a=!1;g.addEventListener("mousedown",this.mouseDown,!1);g.addEventListener("mouseup",this.mouseUp,!1);g.addEventListener("mousemove",
this.mouseMove,!1);g.addEventListener("click",this.mouseClick,!1);g.addEventListener("touchstart",this.touchDown,!1);g.addEventListener("touchend",this.touchUp,!1);g.addEventListener("touchmove",this.touchMove,!1);g.addEventListener("pointerdown",this.mouseDown,!1);g.addEventListener("pointerup",this.mouseUp,!1);g.addEventListener("pointermove",this.mouseMove,!1);g.addEventListener("contextmenu",function(l){l.preventDefault()},!1);g.addEventListener("touchleave",this.touchUp,!1);g.addEventListener("touchenter",
this.touchDown,!1);g.addEventListener("touchcancel",this.touchUp,!1);g.addEventListener("mouseout",function(l){Cb||(Vb=oc=-1,null!=bb&&bb(l));Cb=!1})};var HAniS=new function(){function g(b){var c;Kc=!0;if(b instanceof Array)for(e={},c=0;c<b.length;c++){if(!(2>b[c].length)){var a=b[c].trim();if(0!=a.indexOf("#")){var d=a.indexOf("=");if(!(1>d)){var f=a.substr(0,d).trim().toLowerCase();e[f]=a.substr(d+1).trim()}}}}else e=b;Rd=!1;a=e.debug;null!=a&&("true"==a?(ze=window.open("","HAniSDebugInfo","scrollbars=yes,width=400,height=200"),Rd=!0,fa("HAniS Version 4.8")):Rd=!1);D=!0;a=e.set_className;null!=a&&M(a,"f")&&(D=!1);fa("Is type of param an array = "+
(b instanceof Array));a=e.divalign;null!=a&&(ed=a.trim(),I.align=ed);a=e.initial_message;null!=a&&(c=e.initial_message_style,null==c&&(c="background-color:red;top:10px;left:10px;height:100px;width:200px"),c="z-index:99;position:absolute;"+c,Wb=n("div"),Wb.setAttribute("style",c),Wb.innerHTML=a,Wb.addEventListener("click",function(){Wb.style.visibility="hidden"},!1),Wb.style.visibility="visible",db.appendChild(Wb),a=e.initial_message_timeout,null!=a&&("auto"==a?Ae=!0:(Ae=!1,a=parseInt(e.initial_message_timeout,
10),2>a&&(a=2),setTimeout(function(){Wb.style.visibility="hidden"},1E3*a))));a=e.coordinates;null!=a&&O(a);c="green";b="white";d="12px Arial";f=null;var ca=10,k=10,h=10;Be=2;uf="Lat = ";vf=" Lon = ";a=e.coordinates_display_style;null!=a&&(a=a.split(","),c=a[0].trim(),b=a[1].trim(),d=a[2].trim(),3<a.length&&(uf=a[3],vf=a[4],Be=parseInt(a[5],10),6<a.length&&(f=a[6].trim(),ca=parseInt(a[7],10),k=parseInt(a[8],10),h=parseInt(a[9],10))));wf=new Sa(c,b,d,f,ca,k,h);Sd=rc=null;null!=e.map_scale&&(Td=Xb=!0,
a=e.map_scale.split(","),rc=parseFloat(a[0]),Sd=1<a.length?parseFloat(a[1]):rc);xf=" ";a=e.distance_unit;null!=a&&(xf=a.trim());a=e.divcan_style;null!=a&&a.trim();a=e.imagecan_style;null!=a&&(a=a.trim()+";position:absolute;top:0;left:0;",qb.setAttribute("style",a+"z-index:1;"),Yb.setAttribute("style",a+"z-index:2;"));c="blue";b="white";d="12px Arial";f=null;h=k=ca=10;yf=1;zf="white";a=e.distance_display_style;null!=a&&(a=a.split(","),c=a[0].trim(),b=a[1].trim(),zf=5<=a.length?a[4].trim():b,d=a[2].trim(),
yf=parseInt(a[3],10),5<a.length&&(f=a[5].trim(),ca=parseInt(a[6],10),k=parseInt(a[7],10),h=parseInt(a[8],10)));Vg=new Sa(c,b,d,f,ca,k,h);c="black";b="white";d="12px Arial";f=null;h=k=ca=10;a=e.probe_display_style;null!=a&&(a=a.split(","),c=a[0].trim(),b=a[1].trim(),d=a[2].trim(),3<a.length&&(f=a[3].trim(),ca=parseInt(a[4],10),k=parseInt(a[5],10),h=parseInt(a[6],10)));Wg=new Sa(c,b,d,f,ca,k,h);a=e.pause;null!=a&&(Af=parseInt(a,10));a=e.auto_refresh;null!=a&&(Ce=6E4*parseInt(a,10),sc=setInterval("HAniS.reloadFOF();",
Ce),fd=!0);gd=!1;a=e.enable_smoothing;null!=a&&M(a,"t")&&(gd=!0);Ud=!0;a=e.check_image_size;null!=a&&M(a,"f")&&(Ud=!1);a=e.sprites;if(null!=a){a=a.split(",");De=new Image;Ee=[];Fe=[];Db=[];Eb=[];if("row"==a[1].trim().toLowerCase())for(h=d=b=0,c=2;c<a.length;){"row"==a[c].trim().toLowerCase()&&(b=0,d+=h,h=0,c+=1);k=parseInt(a[c],10);c+=1;f=parseInt(a[c],10);c+=1;ca=parseInt(a[c],10);ca>h&&(h=ca);c+=1;for(var l=0;l<k;l++)Ee.push(b),Fe.push(d),Db.push(f),Eb.push(ca),b+=f}else for(d=!1,c=1;c<a.length;)Ee.push(parseInt(a[c],
10)),c+=1,Fe.push(parseInt(a[c],10)),c+=1,c>=a.length?(b=0,d=!0):b=parseInt(a[c],10),0>b?(d=!0,Db.push(Math.abs(b)),c+=1,b=parseInt(a[c++],10),Eb.push(Math.abs(b))):d?(Db.push(Db[Db.length-1]),Eb.push(Eb[Eb.length-1])):(Db.push(parseInt(a[c],10)),c+=1,Eb.push(parseInt(a[c],10)),c+=1);De.onload=function(){this.gotSprites=!0};De.src=a[0]}a=e.overlay_labels;null!=a&&(Fb=a.split(","));Ge=null;a=e.auto_enhance_background;null!=a&&(Ge=parseInt(a,10)-1);tc=null;a=e.auto_enhance;if(null!=a)for(b=e.overlay_probe_table,
a=a.split(","),tc=Array(a.length),c=0;c<a.length;c++)"x"==a[c].trim().toLowerCase()?tc[c]=-1:tc[c]=parseInt(a[c].trim(),10)-1,null==b&&(uc[c]=tc[c]);vc=!1;Zb=-1;a=e.overlay_enhance;null!=a&&(vc=!0,Zb=parseInt(a,10)-1);$b=null;Lc=!0;a=e.overlay_allow_hoverzones;if(null!=a)for(a=a.split(","),$b=Array(a.length),c=0;c<a.length;c++)if($b[c]=!0,M(a[c],"n")||M(a[c],"f"))$b[c]=!1;W=Y=null;He=Bf=!1;a=e.window_size;null!=a&&(a=a.split(","),"div"==a[0]?He=!0:(W=parseInt(a[0],10),Y=parseInt(a[1],10)),Bf=!0);
hd=[];a=e.use_for_all_frames;if(null!=a)for(a=a.split(","),c=0;c<a.length;c+=2)hd[parseInt(a[c],10)]=parseInt(a[c+1],10)-1;id=-1;a=e.skip_missing;null!=a&&(id=parseInt(a,10));Cf="#00000000";a=e.skip_missing_color;null!=a&&(Cf=a);Vd=null;a=e.overlay_spacer;if(null!=a)for(a=a.split(","),Vd=Array(a.length),c=0;c<a.length;c++)Vd[c]=parseInt(a[c],10);a=e.overlay_probe_table;if(null!=a)for(a=a.split(","),c=0;c<a.length;c++)"x"==a[c].trim().toLowerCase()?uc[c]=-1:uc[c]=parseInt(a[c],10)-1;wc=null;a=e.overlay_order;
null==a&&(a=e.overlay_zorder);if(null!=a)for(a=a.split(","),wc=Array(a.length),c=0;c<a.length;c++)wc[parseInt(a[c],10)-1]=c;Gb=null;a=e.overlay_links;if(null!=a)for(a=a.split(","),Gb=Array(a.length),c=0;c<a.length;c++)Gb[c]=parseInt(a[c],10);Df=[];Ca=null;a=e.overlay_slice;if(null!=a)for(a=a.split(","),c=0;c<a.length;c++)Df[parseInt(a[c],10)-1]=!0;Ef=!0;a=e.slice_smoothing;M(a,"f")&&(Ef=!1);Mc=null;a=e.overlay_clear;if(null!=a)for(a=a.split(","),Mc=Array(a.length),c=0;c<a.length;c++)Mc[c]=a[c].trim().toLowerCase();
Ff=!1;a=e.transparency;null!=a&&(a=a.split(","),1==a.length?Gf=Hf=If=parseInt(a[0],10):(Gf=parseInt(a[0],10),Hf=parseInt(a[1],10),If=parseInt(a[2],10)),Ff=!0);Ie=!1;a=e.transparency_list;if(null!=a){a=a.split(",");Jf=[];for(c=0;c<a.length;c++)Jf[parseInt(a[c].trim(),10)-1]=!0;Ie=!0}Wd=null;a=e.overlay_transparent_amount;if(null!=a)for(a=a.split(","),Wd=Array(a.length),c=0;c<a.length;c++)Wd[c]=parseFloat(a[c])/100;xc=null;a=e.overlay_zoom;if(null!=Fb&&null!=a)for(a=a.split(","),xc=Array(a.length),
c=0;c<a.length;c++)if(xc[c]=1,M(a[c],"n")||M(a[c],"f"))xc[c]=0;else if(M(a[c],"d")||M(a[c],"h"))xc[c]=-1;eb=null;Kf=[];a=e.overlay_preserve_list;if(null!=Fb&&null!=a)for(a=a.split(","),eb=Array(a.length),c=0;c<a.length;c++){eb[c]=!0;if(M(a[c],"n")||M(a[c],"f"))eb[c]=!1;if(M(a[c],"a")||M(a[c],"A"))Kf[c]=!0}Z=null;if(null!=Fb&&null!=eb)for(a=e.overlay_preserve.split(","),d=e.overlay_preserve_position,null!=d&&(d=d.split(",")),Z=Array(eb.length),c=f=0;c<eb.length;c++)if(eb[c]){Z[c]=Array(6);for(b=0;4>
b;b++)Z[c][b]=parseInt(a[f].trim(),10),f+=1;Z[c][2]=Z[c][2]-Z[c][0]+1;Z[c][3]=Z[c][3]-Z[c][1]+1;null!=d?(Z[c][4]=parseInt(d[f/2-2],10),Z[c][5]=parseInt(d[f/2-1],10)):(Z[c][4]=Z[c][0],Z[c][5]=Z[c][1])}Xd=0;Lf=" ";ac="white";jd="transparent";kd="14pt arial";Mf=!1;a=e.times_label_style;null!=a&&(a=a.split(","),ac=a[0].trim(),1<a.length&&(Xd=Math.floor(60*parseFloat(a[1]))),1<a.length&&(Xd="?"==a[1].trim()||"auto"==a[1].trim().toLowerCase()?-Math.floor((new Date).getTimezoneOffset()):Math.floor(60*parseFloat(a[1]))),
2<a.length&&(Lf=a[2].trim()),3<a.length&&(jd=a[3].trim()),4<a.length&&(kd=a[4].trim()),5<a.length&&-1!=a[5].trim().indexOf("t")&&(Mf=!0));0==ac.indexOf("0x")&&(ac="#"+ac.substring(2));0==jd.indexOf("0x")&&(jd="#"+jd.substring(2));Nc=parseInt(kd,10);Xg=new Sa("black","white",kd,"black",20,5,5);Nf=!1;a=e.to_from_lock;null!=a&&(Nf=M(a,"t")?!0:!1);ca="black";k="white";h="14px arial";c=null;f=d=b=10;Of=Pf=" ";Je=Oc=null;a=e.dirspd_display_style;null!=a&&(a=a.split(","),ca=a[0].trim(),k=a[1].trim(),h=a[2].trim(),
Of=a[3],Pf=a[4],5<a.length&&(c=a[5].trim(),b=parseInt(a[6],10),d=parseInt(a[7],10),f=parseInt(a[8],10)),Je=new Sa(ca,k,h,c,b,d,f));c="black";b="white";d="14px arial";f=null;h=k=ca=10;a=e.tipbox_display_style;null!=a&&(a=a.split(","),c=a[0].trim(),b=a[1].trim(),d=a[2].trim(),3<a.length&&(f=a[3].trim(),ca=parseInt(a[4],10),k=parseInt(a[5],10),h=parseInt(a[6],10)));Qf=new Sa(c,b,d,f,ca,k,h);Yd=null;da=e.image_base;null!=da?Yd=da=da.trim():da=null!=e.image_only_base?e.image_only_base.trim():null;Rf=da;
a=e.overlay_base;null!=a&&(bc=a.trim());Kc=!0;a=e.filenames;if(null!=a){a=a.split(",");v=a.length;ra=Array(v);for(c=0;c<v;c++)ra[c]=null!=da?da+a[c].trim():a[c].trim();Kc=!1;na=0}a=e.basename;if(null!=a){b=a;null!=da&&(b=da+a);a=e.base_starting_number;null==a&&(a=0);v=e.num_frames;null==v&&(v=e.num_images);v=parseInt(v,10);ra=Array(v);for(c=0;c<v;c++){d=c+parseInt(a,10);if(0<=b.indexOf("*"))ra[c]=b.replace("*",d);else if(0<=b.indexOf("?")){for(f=b;0<=f.lastIndexOf("?");)ca=f.lastIndexOf("?"),f=f.substring(0,
ca)+d%10+f.substring(ca+1),d=Math.floor(d/10);ra[c]=f}else ra[c]=b+c;fa("image filename = "+ra[c])}a=e.reverse_order;null!=a&&M(a,"t")&&ra.reverse();Kc=!1;na=0}Ke=!0;a=e.background_static;null!=a&&(M(a,"f")||M(a,"n"))&&(Ke=!1);a=e.overlay_filenames;if(null!=a){a=a.split(",");oa=Array(v);for(c=0;c<a.length;c++)for(d=a[c].split("&"),na=a.length,b=0;b<v;b++)0==c&&(oa[b]=Array(na)),oa[b][c]=d[b].trim(),null!=bc?oa[b][c]=(bc+oa[b][c]).trim():null!=da&&(oa[b][c]=(da+oa[b][c]).trim());Kc=!1}va=null;a=e.image_preserve;
if(null!=a)for(a=a.split(","),va=[],c=0;c<a.length;c++)va[c]=parseInt(a[c].trim(),10),1<c%4&&(va[c]=va[c]-va[c-2]+1);Sf=!0;a=e.keep_zoom;null!=a&&M(a,"f")&&(Sf=!1);Pc=Tf=0;a=e.hide_bottom;null!=a&&(Tf=parseInt(a.trim(),10));Zd=Uf=0;a=e.hide_top;null!=a&&(Uf=parseInt(a.trim(),10));Vf="<div>";Wf=300;Xf=500;a=e.popup_style;null!=a&&(Vf='<div style="'+a+'">');a=e.popup_window_size;null!=a&&(a=a.split(","),Xf=a[0],Wf=a[1]);Yf=sa=!1;a=e.active_zoom;null!=a&&M(a,"t")&&(sa=!0,la.useWheel(HAniS.wheel));a=
e.initial_zoom;null!=a&&(a=a.split(","),cc="auto"!=a[0].toLowerCase()?parseFloat(a[0]):"auto",1<a.length?(ld=parseInt(a[1],10),Zf=parseInt(a[2],10)):ld=-1,$f=!0);md=1;a=e.zoom_scale;null!=a&&(md=parseFloat(a));nd=9999999;a=e.maximum_zoom;null!=a&&(nd=parseFloat(a));Le=!0;a=e.use_progress_bar;null!=a&&M(a,"f")&&(Le=!1);a=e.dwell;null!=a&&(a=a.split(","),Ta=parseInt(a[0].trim(),10),1<a.length&&(Hb=parseInt(a[1].trim(),10),10>Hb&&(Hb=10),yc=parseInt(a[2].trim(),10),Me=parseInt(a[3].trim(),10)));a=e.rate;
null!=a&&(a=a.split(","),Ta=Math.round(1E4/parseFloat(a[0].trim())),1<a.length&&(Hb=Math.round(1E4/parseFloat(a[2].trim())),10>Hb&&(Hb=10),yc=Math.round(1E4/parseFloat(a[1].trim()))));a=e.frame_times_template;null!=a&&(a=a.split(","));fb=null;a=e.times;if(null!=a){a=a.split(",");fb=Array(a.length);for(c=0;c<a.length;c++)fb[c]=parseInt(a[c].trim(),10);Kd(fb)}a=e.extrap_times_filename;if(null!=a){fb=[];var N=new XMLHttpRequest;N.open("get",a,!0);N.onload=function(){for(var a=N.responseText.split("\n"),
c=0;c<a.length;c++){var b=a[c].split(" ");if(3==b.length){b[2].trim();var d=parseInt(b[0],10)-1;fb[d]=100*parseInt(b[2].substring(0,2),10)+parseInt(b[2].substring(3,5),10)+parseInt(b[2].substring(6,8),10)/30}}Kd(fb)};N.send()}od=null;a=e.extrap_times_template;null!=a&&(od=RegExp(a));ag=["Click on target's initial position","Click on target's final position","Move pointer around or click here to select target"];bg=10;a=e.extrap_prompts_position;null!=a&&M(a,"bot")&&(bg=9999);a=e.extrap_prompts;null!=
a&&(ag=a.split(","));$d=["Click on first point to mark","Save points","Remove last point"];a=e.mark_prompts;null!=a&&($d=a.split(","));Ne="12pt Arial";cg="white";a=e.mark_prompts_style;null!=a&&(a=a.split(","),Ne=a[0].trim(),1<a.length&&(cg=a[1].trim()));a=e.probe_table;if(null!=a){c=new XMLHttpRequest;gb=[];ae=[];zc=[];var pd=" ";Ac=[];var m="Value=";Ib=[];var g=1;Bc=[];Oe=[];Ka=[];La=[];Ma=[];var r,A=-1;t=-1;var w=0;c.onload=function(){for(var a=this.responseText.split("\n"),c=0;c<a.length;c++)if(!(2>
a[c].length)){var b=a[c].replace(/\s+/g," ").trim().split(","),d=b[0].split(" ");if(0==d[0].indexOf("*"))t++,gb[t]=[],Ac[t]=[],zc[t]=[],Ib[t]=[],Ka[t]=[],La[t]=[],Ma[t]=[],Oe[t]=[],Bc[t]=[],A=-1,ae[t]=1<b.length?b[1].trim():"None",w=1;else if(0!=w){A++;var f=Array(3);gb[t][A]=parseFloat(d[0]);Ka[t][A]=parseInt(d[1].trim(),10);La[t][A]=parseInt(d[2].trim(),10);Ma[t][A]=parseInt(d[3].trim(),10);0!=A&&(f[0]=Ka[t][A]-Ka[t][A-1],f[1]=La[t][A]-La[t][A-1],f[2]=Ma[t][A]-Ma[t][A-1],r=0,Math.abs(f[1])>Math.abs(f[r])&&
(r=1),Math.abs(f[2])>Math.abs(f[r])&&(r=2),Oe[t][A-1]=r,Bc[t][A-1]=f,0==Bc[t][A-1][r]&&(Bc[t][A-1][r]=1));1<b.length&&(0==b[1].trim().indexOf('"')?(g=-1,b=b[1].trim(),m=b.substr(1,b.length-2),pd=""):(g=parseInt(b[1],10),2<b.length&&(pd=b[2].trim()),3<b.length&&(m=b[3].trim())));Ac[t][A]=m;Ib[t][A]=g;zc[t][A]=pd}}};c.open("get",a,!0);c.send()}dg=e.controls;fa("controls = "+e.controls);fa("bottom_controls = "+e.bottom_controls);dc=qd=Jb=Kb=Ua=Va=hb=null;null!=dg&&Ld(dg,!0);eg=e.bottom_controls;null!=
eg&&Ld(eg,!1);a=e.enhance_filename;null==a&&(a=e.enhance_table);if(null!=a){fa("Reading enhancement table...");N=new XMLHttpRequest;gb=[];zc=[];ae=[];Ac=[];Ib=[];Ka=[];La=[];Ma=[];rd=[];t=-1;fg=!0;var z=!1,p,q,x,Pe,u,B,E,y,J,C,H,G,F;N.onload=function(){for(var a=this.responseText.split("\n"),c=0;c<a.length;c++)if(!(2>a[c].length)){var b=a[c].replace(/\s+/g," ").trim(),d=b.indexOf("#");if(0!=d)if(0<d&&(b=b.substring(0,d)),d=b.split(","),0==d[0].indexOf("*"))t++,gb[t]=Array(256),Ac[t]=Array(256),zc[t]=
Array(256),Ib[t]=Array(256),Ka[t]=Array(256),La[t]=Array(256),Ma[t]=Array(256),rd[t]=Array(256),gb[t]=Array(256),ae[t]=1<d.length?d[1].trim():"None",pd=" ",m="Value =",g=1,b=n("option"),b.innerHTML=d[0].substring(1),b.value=t,null!=wa&&wa.add(b);else{var f=b.indexOf("value");0>f&&(f=b.indexOf("probe"));z=!1;C=H=0;0<f&&(d=b.substring(f+1),b=b.substring(0,f),f=d.indexOf("="),d=d.substring(f+1),d=d.split(","),1==d.length?(m=d[0].trim(),g=-1,z=!1):(C=parseFloat(d[0].trim()),H=parseFloat(d[1].trim()),
2<d.length&&(g=parseInt(d[2],10)),3<d.length&&(pd=d[3].trim()),4<d.length&&(m=d[4].trim()),z=!0));b=b.split(" ");p=parseInt(b[0].trim(),10);q=parseInt(b[1].trim(),10);x=q-p;Pe=parseFloat(b[2].trim());u=parseFloat(b[3].trim());B=parseFloat(b[4].trim());E=parseFloat(b[5].trim());y=parseFloat(b[6].trim());J=parseFloat(b[7].trim());G=F=255;9<b.length&&(G=parseFloat(b[8].trim()),F=parseFloat(b[9].trim()));for(b=p;b<=q;b++)0==x?(Ka[t][p]=Pe,La[t][p]=B,Ma[t][p]=y,rd[t][p]=G):(Ka[t][b]=Math.round(Pe+(u-Pe)*
(b-p)/x),La[t][b]=Math.round(B+(E-B)*(b-p)/x),Ma[t][b]=Math.round(y+(J-y)*(b-p)/x),rd[t][b]=Math.round(G+(F-G)*(b-p)/x)),Ac[t][b]=m,zc[t][b]=pd,Ib[t][b]=g,z&&(gb[t][b]=C+(H-C)*(b-p)/x)}}V()};N.open("get",a,!0);N.send()}else V()}function V(){var b=e.sprite_filenames;if(null!=b){var c=b.split(",");gg=0;xa=[];b=e.sprite_images_offset;sd=0;null!=b&&(sd=parseInt(b,10)-1);for(b=0;b<c.length;b++)xa[b]=new Image,xa[b].gotit=!1,xa[b].inx=b,xa[b].anim=!0,xa[b].onload=function(){xa[this.inx].gotit=!0;gg++;gg==
c.length&&T()},xa[b].src=c[b].trim()}else T()}function T(){for(var b=Object.keys(e),c=0;c<b.length;c++)M(b[c],"hotspot")&&Ic("hotspot="+e[b[c]]);Kc?HAniS.getFOF():(td=!0,cd())}function O(b){b=b.split(",");var c=b[0].trim();"PS"===c?(Na=new lh,Na.init(b)):"CE"==c?(Na=new mh,Na.init(b)):"LCC"==c?(Na=new nh,Na.init(b)):(Na=null,ud=parseFloat(b[0]),be=parseFloat(b[1]),hg=parseFloat(b[2]),ig=parseFloat(b[3]))}function zb(b){var c=new XMLHttpRequest;c.onload=function(){g(this.responseText.split("\n"))};
c.open("get",b+"?"+Math.round(1E5*Math.random()),!0);c.send()}function ye(b){var c;if(null!=Mc){for(c=0;c<Mc.length;c++)-1!=Mc[c].indexOf(b)&&(z[c].checked=!1);for(c=0;c<Mc.length;c++)ab(c)}}function Kd(b){Qe=Array(b.length);for(var c=0;c<b.length;c++){var a=60*Math.floor(b[c]/100)+Math.floor(b[c])%100;0==c&&(Lb=a);var d=a-Lb;0>d&&(d=a+1440-Lb);Qe[c]=d;fa("times s="+a+"  min="+Qe[c])}Lb+=Xd;1440<=Lb&&(Lb-=1440);0>Lb&&(Lb+=1440);fa("Starting minute = "+Lb)}function Ub(b,c){if(0!=b)for(var a=0;a<b;a++)0==
z[ya[a].overlay].isGhost&&(z[ya[a].overlay].parentNode.style.visibility=c)}function Ab(){0!=ib?Ub(ib,"visible"):0!=jg&&Ub(jg,"hidden");td=!0;cd()}function $a(b,c){Qc||(qb.height=c,qb.width=b,Yb.height=c,Yb.width=b,ce.height=c,ce.width=b,vd=ce.getContext("2d"),W=b,Y=c,de=W/2-100,ee=Y/2-10,q=1*ia/W,x=1*X/Y,kg&&(kg=!1,null!=lg&&lg()),db.style.height=Y+"px",db.style.width=W+"px",rb.style.height=Y+"px",rb.style.width=W+"px",dd(v,!1))}function cd(){var b,c,a,d="?"+Math.round(1E4*Math.random());za=Array(v);
ec=Wa=0;mg=Le;Re&&(jb.max=v);Qc&&(Rc||vc)&&(Mb=[],Da=[],Cc=[],Se=[],fe=[]);null!=wa&&(wa.selectedIndex=0);for(b=0;b<v;b++){Qc&&(Rc||vc)&&(Mb[b]=n("canvas"),Da[b]=n("canvas"));za[b]=new Image;za[b].gotit=!1;za[b].frameNum=b;za[b].onerror=function(){Wa++};za[b].onload=function(){Qc&&(X=this.height,ia=this.width,Aa=X,Oa=ia,Qc=!1,Bf?He?HAniS.setWindowSize(I.offsetWidth,I.offsetHeight):$a(W,Y):$a(ia,X),$f&&("auto"==cc&&(cc=(q+x)/2,ld=-1),Aa/=cc,Oa/=cc,0>ld&&(ld=ia/2,Zf=X/2),J=Math.round(ld-ia/2/cc),E=
Math.round(Zf-X/2/cc),P=S=cc,1!=cc&&(sa=!1,HAniS.toggleZooming())));if(0<ge&&!Sc){Te.height=X;Te.width=ia;wd=Te.getContext("2d");wd.clearRect(0,0,W,Y);for(var b=0;b<Ea.length;b++){for(var f=Ea[b].ctx.getImageData(0,0,Ea[b].width,Ea[b].height).data,e=wd.getImageData(Ea[b].xmin,Ea[b].ymin,Ea[b].width,Ea[b].height),l=3;l<f.length;l+=4)0!=f[l]&&(e.data[l]=b+1);wd.putImageData(e,Ea[b].xmin,Ea[b].ymin)}sa||(Xa=!0);1==P&&(Xa=!0);Sc=!0}if(td){td=!1;y=qb.getContext("2d");y.imageSmoothingEnabled=gd;y.fillStyle=
"blue";y.font="bold 20px Arial";k=Yb.getContext("2d");k.imageSmoothingEnabled=gd;Fa=Array(v);dd(v,!0);Ba(qa(w));if(0<na)for(C=Array(v),a=0;a<v;a++)for(C[a]=Array(na),c=0;c<na;c++)C[a][c]=new Image,C[a][c].gotit=!1,C[a][c].frameNum=a,C[a][c].overlayNum=c,C[a][c].onerror=function(){Wa++},C[a][c].onload=function(){this.gotit=!0;Wa++;Qd();!Ud||this.height==X&&this.width==ia?this.overlayNum==id-1&&(Fa[this.frameNum]=0):(this.gotit=!1,fa("Bad image size:"+this.src));if(vc&&this.gotit&&this.overlayNum==
Zb){var a=this.frameNum;Mb[a].height=this.height;Mb[a].width=this.width;xd=Mb[a].getContext("2d");xd.drawImage(this,0,0);Se[a]=xd.getImageData(0,0,this.width,this.height).data;Da[a].height=this.height;Da[a].width=this.width;Cc[a]=Da[a].getContext("2d");Cc[a].drawImage(this,0,0);fe[a]=Cc[a].getImageData(0,0,this.width,this.height);C[a][this.overlayNum]=null;C[a][this.overlayNum]=Da[a];C[a][this.overlayNum].gotit=!0}else if(this.gotit&&z[this.overlayNum].hotspotIndex){a=this.frameNum;var b=n("canvas");
b.height=this.height;b.width=this.width;var c=b.getContext("2d");c.drawImage(this,0,0);var d=c.getImageData(0,0,this.width,this.height).data,f=d.length;var e=this.overlayNum;var h;for(h=0;h<f;h+=4)if(0!=d[h]){var k=d[h];var l=Math.floor(h/4/b.width);c=Math.floor(h/4%b.width);fc[kb]=new Vb(c,l,"sprite",k,"pan",null,null,e,a,null);kb++}}else if(this.gotit&&Ff&&(!Ie||Ie&&Jf[this.overlayNum])){a=this.frameNum;b=n("canvas");b.height=this.height;b.width=this.width;c=b.getContext("2d");c.drawImage(this,
0,0);l=c.getImageData(0,0,this.width,this.height);d=l.data;f=d.length;for(h=0;h<f;h+=4)d[h]===Gf&&d[h+1]===Hf&&d[h+2]===If&&(d[h+3]=0);c.putImageData(l,0,0);C[a][this.overlayNum]=null;C[a][this.overlayNum]=b;C[a][this.overlayNum].gotit=!0}this.gotit&&Df[this.overlayNum]&&null!=Ca&&(a=this.frameNum,b=n("canvas"),b.height=X,b.width=ia,c=b.getContext("2d"),c.imageSmoothingEnabled=Ef,c.drawImage(this,Ca[0],Ca[1],Ca[2],Ca[3],0,0,ia,X),C[a][this.overlayNum]=null,C[a][this.overlayNum]=b,C[a][this.overlayNum].gotit=
!0,null!=eb&&eb[this.overlayNum]&&(C[a][this.overlayNum].origImage=this))},b=oa[a][c],void 0!=hd[c+1]&&(b=hd[c+1],b>=v&&(b=v-1),b=oa[b][c]),void 0==yd||yd[c]||(b+=d),C[a][c].src=b,ec++;if(null!=gc)for(Nb=[],c=0;c<gc.length;c++)Nb[c]=new Image,Nb[c].gotit=!1,Nb[c].onerror=function(a){Wa++},Nb[c].onload=function(a){a.currentTarget.gotit=!0;Wa++;Qd()},Nb[c].src=gc[c],ec++;if(null!=hc)for(Ob=[],c=0;c<gc.length;c++)Ob[c]=new Image,Ob[c].gotit=!1,Ob[c].onerror=function(a){Wa++},Ob[c].onload=function(a){a.currentTarget.gotit=
!0;Wa++;Qd()},Ob[c].src=hc[c],ec++}!Ud&&0!=this.height&&0!=this.width||this.height==X&&this.width==ia?(this.gotit=!0,0==id&&(Fa[this.frameNum]=0)):(this.gotit=!1,fa("Image has invalid size:"+this.src));Rc&&this.gotit&&(b=this.frameNum,Mb[b].height=this.height,Mb[b].width=this.width,xd=Mb[b].getContext("2d"),xd.drawImage(this,0,0),Se[b]=xd.getImageData(0,0,this.width,this.height).data,Da[b].height=this.height,Da[b].width=this.width,Cc[b]=Da[b].getContext("2d"),Cc[b].drawImage(this,0,0),fe[b]=Cc[b].getImageData(0,
0,this.width,this.height),za[b]=null,za[b]=Da[b],za[b].gotit=!0);Wa++;Qd();Sf||HAniS.resetZoom();Ue=!0;Yg||(Yg=!0,Ya=!1,Zg());ea(Pb)};var f=ra[b];void 0!=hd[0]&&(f=hd[0],f>=v&&(f=v-1),f=ra[f]);Ke||(f+=d);za[b].src=f;ec++}Dc=sb=!1;U()}function ha(b,c,a,d,f){b.label_on=a;b.label_off=d;a=null;d=e[c+"_labels"];null==d&&(d=e[c+"_label"]);null!=d&&(d=d.split(","),b.label_on=d[0].trim(),1<d.length&&(b.label_off=d[1].trim()),2<d.length&&(a="width:"+d[2].trim()+"px;"));null!=f&&(b.title=f);b.innerHTML=b.label_on;
f=c=d=e[c+"_style"];null!=d&&(d=d.split("&"),1<d.length&&(c=d[0],f=d[1]));b.style_on=(null!=a?a:"")+ic+c;b.style_off=(null!=a?a:"")+ic+f;null!=b.style_on&&1<b.style_on.length?b.setAttribute("style",b.style_on):(b.style_on=null,b.style_off=null)}function Ld(b,c){ic=e.buttons_style;null==ic&&(ic="");var a=null,d=null;a=c?e.controls_tooltip:e.bottom_controls_tooltip;var f=b.split(",");if(null!=a){var k=a.split(",");k.length!=f.length&&(fa("!!! Number of tooltips must equal number of controls!"),k=a=
null)}for(b=0;b<f.length;b++){var K=null!=a?k[b]:null;var h=f[b].trim();d=h.indexOf("/");if(0===d||0===b){0===d&&(h=h.substring(1));B=n("div");B.align=ed;var g=e.controls_style;null!=g?B.setAttribute("style",g):B.setAttribute("style","position:relative;padding:2px;width:100%;");c?(I.insertBefore(B,db),Ve=B):(g=e.bottom_controls_style,null!=g&&B.setAttribute("style",g),I.appendChild(B),We=B)}"enhance"==h.trim()&&(wa=n("select"),d=e.enhance_style,null!=d&&wa.setAttribute("style",d),null!=K&&(wa.title=
K),d=n("option"),d.innerHTML="Pick Enhancement",d.value=-1,wa.add(d),wa.addEventListener("change",HAniS.doEnhance,!1),Rc=!vc,wa.disabled=Rc?!1:!0,B.appendChild(wa));"startstop"==h&&(hb=n("button"),D&&(hb.className="startstop start"),ha(hb,"startstop","Start","Stop",K),hb.addEventListener("click",HAniS.toggleIsLooping,!1),B.appendChild(hb));"looprock"==h&&(Tc=n("button"),D&&(Tc.className="looprock rock"),ha(Tc,"looprock","Rock","Loop",K),Xe=1,Tc.addEventListener("click",HAniS.toggleLoopRock,!1),B.appendChild(Tc));
"extrap"==h&&(tb=n("button"),D&&(tb.className="extrap"),ha(tb,"extrap","Enable Extrap","Disable Extrap",K),tb.addEventListener("click",HAniS.toggleExtrap,!1),B.appendChild(tb));M(h,"location")&&(Ec=n("button"),D&&(Ec.className="location"),ha(Ec,"location","Show Loc","Hide Loc",K),0<h.indexOf("/on")?(H(Ec,!1,"location off"),Uc=!0):Uc=!1,Ec.addEventListener("click",function(){(Uc=!Uc)?H(Ec,!1,"location off"):H(Ec,!0,"location on")},!1),B.appendChild(Ec));"distance"==h&&(ub=n("button"),D&&(ub.className=
"distance"),ha(ub,"distance","Show dist","Hide dist",K),Xb=Td=!1,ub.addEventListener("click",function(){(Xb=!Xb)?H(ub,!1,"distance off"):H(ub,!0,"distance on")},!1),B.appendChild(ub));"probe"==h&&(Vc=n("button"),D&&(Vc.className="probe"),ha(Vc,"probe","Show probe","Hide probe",K),Fc=Ye=!1,ng="Undefined",og=!1,zd=0,g=e.probe_undefined,null!=g&&(d=g.split(","),ng=d[0].trim(),1<d.length&&(zd=parseInt(d[1],10)+1),2<d.length&&(og=!0)),Ze=!1,e.probe_base_image&&(Ze=!0),Vc.addEventListener("click",function(){(Ye=
!Ye)?(H(Vc,!1,"probe off"),Fc=!0):(H(Vc,!0,"probe on"),Fc=!1)},!1),B.appendChild(Vc));"mark"==h&&(jc=n("button"),D&&(jc.className="mark"),ha(jc,"mark","Mark","Stop Mark",K),Ad=!0,jc.addEventListener("click",function(){lb=!lb;ja=[];lb?(Wc=0,H(jc,!1,"mark off"),null!=ta&&(ta.disabled=!0)):(H(jc,!0,"mark on"),null!=ta&&(ta.disabled=!1),Wc=-1);U()},!1),$g=new Sa("black","white",Ne,"black",20,5,5),pg=new Sa("black","white",Ne,"black",20,5,5),B.appendChild(jc));"refresh"==h&&(qd=n("button"),D&&(qd.className=
"refresh"),ha(qd,"refresh","Refresh",null,K),qd.addEventListener("click",HAniS.reloadFOF,!1),B.appendChild(qd));"setframe"==h&&(jb=n("input"),D&&(jb.className="setframe"),jb.type="range",jb.min=1,jb.max=100,jb.value=1,he="Frame #*",g=e.setframe_label,null!=g&&(he=g),Bd=n("span"),Bd.innerHTML=he.replace("*",1),d="display:block;vertical-align:middle;"+e.setframe_style,jb.setAttribute("style",d),d=n("span"),d.setAttribute("style","display:inline-block;vertical-align:top;"),Bd.setAttribute("style","display:block;vertical-align:middle;"+
e.setframe_label_style),d.appendChild(Bd),d.appendChild(jb),B.appendChild(d),jb.addEventListener("input",function(a){ea(!1);a=parseInt(jb.value,10)-1;0<=Fa[a]&&(Ba(a),Bd.innerHTML=he.replace("*",w+1));l()},!1),Re=!0);"framelabel"==h&&(Ga=n("button"),D&&(Ga.className="framelabel"),Ga.innerHTML="",Pa=null,g=e.frame_labels,null!=g&&(Pa=g.split(","),Ga.innerHTML=Pa[0]),d=ic+e.framelabel_style,null!=d&&Ga.setAttribute("style",d),d=e.framelabel_position,null!=d&&(d=d.split(","),Ga.style.position="absolute",
Ga.style.left=I.offsetLeft+parseInt(d[0],10)+"px",Ga.style.top=I.offsetTop+parseInt(d[1],10)+"px"),B.appendChild(Ga));if("autorefresh"==h||"autorefresh/off"==h)null!=sc&&clearInterval(sc),dc=n("button"),D&&(dc.className="autorefresh"),ha(dc,"autorefresh","Disable Auto Refresh","Enable Auto Refresh",K),dc.addEventListener("click",HAniS.toggleAutoRefresh,!1),fd=!1,B.appendChild(dc),"autorefresh"==h?HAniS.toggleAutoRefresh():H(dc,!1,"autotoggle off");"backward"==h&&(Ua=n("button"),D&&(Ua.className="step back"),
ha(Ua,"backward","<","<",K),Ua.addEventListener("click",function(){ea(!1);bb(-1);l()},!1),B.appendChild(Ua));"forward"==h&&(Va=n("button"),D&&(Va.className="step forward"),ha(Va,"forward",">",">",K),Va.addEventListener("click",function(){ea(!1);bb(1);l()},!1),B.appendChild(Va));if("step"==h){d=e.step_labels;var N=null!=d?d.split(","):["<",">"];Ua=n("button");D&&(Ua.className="step back");Ua.innerHTML=N[0];Ua.addEventListener("click",function(){ea(!1);bb(-1);l()},!1);d=ic+e.step_style;null!=d&&Ua.setAttribute("style",
d);null!=K&&(Ua.title=K);B.appendChild(Ua);Va=n("button");D&&(Va.className="step forward");Va.innerHTML=N[1];Va.addEventListener("click",function(){ea(!1);bb(1);l()},!1);null!=d&&Va.setAttribute("style",d);null!=K&&(Va.title=K);B.appendChild(Va)}"first"==h&&(mb=n("button"),D&&(mb.className="firstlast first"),ha(mb,"first","|<","|<",K),mb.addEventListener("click",function(){ea(!1);Ba(qa(0));l()},!1),B.appendChild(mb));"last"==h&&(nb=n("button"),D&&(nb.className="firstlast last"),ha(nb,"last",">|",
">|",K),nb.addEventListener("click",function(){ea(!1);Ba(qa(v-1));l()},!1),B.appendChild(nb));"firstlast"==h&&(d=e.firstlast_labels,N=null!=d?d.split(","):["<<",">>"],mb=n("button"),D&&(mb.className="firstlast"),mb.innerHTML=N[0],mb.addEventListener("click",function(){ea(!1);Ba(qa(0));l()},!1),d=ic+e.firstlast_style,null!=d&&mb.setAttribute("style",d),null!=K&&(mb.title=K),B.appendChild(mb),nb=n("button"),D&&(nb.className="firstlast"),nb.innerHTML=N[1],nb.addEventListener("click",function(){ea(!1);
Ba(qa(v-1));l()},!1),null!=d&&nb.setAttribute("style",d),null!=K&&(nb.title=K),B.appendChild(nb));"setspeed"==h?(vb=n("input"),D&&(vb.className="setspeed"),vb.type="range",vb.min=Hb,vb.max=yc,vb.value=yc-Ta,null!=K&&(vb.title=K),d="vertical-align:middle;"+e.setspeed_style,vb.setAttribute("style",d),vb.addEventListener("input",function(a){Ta=yc-parseInt(vb.value,10)+30;ea(!0);l()},!1),B.appendChild(vb)):"speed"==h&&(d=e.speed_labels,N=null!=d?d.split(","):["-","+"],Jb=n("button"),D&&(Jb.className=
"speed slower"),Jb.innerHTML=N[0],Jb.addEventListener("click",function(){Ta+=Me;Kb.disabled=!1;Ta>yc&&(Ta=yc,Jb.disabled=!0)},!1),d=ic+e.speed_style,null!=d&&Jb.setAttribute("style",d),null!=K&&(Jb.title=K),B.appendChild(Jb),Kb=n("button"),D&&(Kb.className="speed faster"),Kb.innerHTML=N[1],Kb.addEventListener("click",function(){Ta-=Me;Jb.disabled=!1;Ta<Hb&&(Ta=Hb,Kb.disabled=!0)},!1),null!=d&&Kb.setAttribute("style",d),null!=K&&(Kb.title=K),B.appendChild(Kb));"zoom"==h&&(ta=n("button"),D&&(ta.className=
"zoom off"),ha(ta,"zoom","Zoom","Un-zoom",K),ta.addEventListener("click",HAniS.toggleZooming,!1),B.appendChild(ta));if("annotate"==h){Xc=n("button");D&&(Xc.className="annotate");ha(Xc,"annotate","Annotate","Finished",K);ma=n("div");ma.setAttribute("style","position:absolute;height:120px;width:180px;top:20px;left:20px;z-index:5;visibility:hidden;background-color:lightgray;border-width:3px;border-style:solid;border-color:magenta;border-radius:25px;padding:10px;font-family:Arial;font-size:16px;color:black;");
ma.title="Drag this box around.  Select attributes, then go onto the image and click & drag";kc=lc=20;ie=Yc=!1;qg=3;rg=11;r=[];ma.addEventListener("mousedown",function(a){ie=!0;sg=a.clientX-lc;tg=a.clientY-kc},!1);ma.addEventListener("mouseup",function(a){ie=!1},!1);ma.addEventListener("mouseout",function(a){ie&&(lc=a.clientX-sg,kc=a.clientY-tg,ma.style.top=kc+"px",ma.style.left=lc+"px")},!1);ma.addEventListener("mousemove",function(a){ie&&(lc=a.clientX-sg,kc=a.clientY-tg,ma.style.top=kc+"px",ma.style.left=
lc+"px")},!1);Xc.addEventListener("click",function(){if(Yc=!Yc){r=[];lc=I.offsetLeft;kc=I.offsetTop;var a=e.annotate_position;null!=a&&(a=a.split(","),lc+=parseInt(a[0],10),kc+=parseInt(a[1],10));ma.style.top=kc+"px";ma.style.left=lc+"px";ma.style.visibility="visible";H(Xc,!1,"annotate off");ah=sa;sa=!1;null!=ta&&(ta.disabled=!0)}else ma.style.visibility="hidden",H(Xc,!0,"annotate on"),sa=ah,null!=ta&&(ta.disabled=!1);U()},!1);Cd=ug("Color Black White Red Green Blue Cyan Magenta".split(" "),"black black white red green blue cyan magenta".split(" "),
function(a){});mc=ug("Width 1 2 3 4 5 6 7 8 10 12 14 16 18 20 24 28 32 36 38".split(" "),[1,1,2,3,4,5,6,7,8,10,12,14,16,18,20,24,28,32,36,38],function(a){6==Dd.selectedIndex?rg=mc.selectedIndex:qg=mc.selectedIndex});mc.title="Select width or font size";Dd=ug("Type Arrow Circle Box Polygon Draw Text".split(" "),[-1,0,1,2,3,4,5],function(a){6==Dd.selectedIndex?(wb.focus(),wb.select(),mc.selectedIndex=rg):mc.selectedIndex=qg;0==Cd.selectedIndex&&(Cd.selectedIndex=2)});d=n("button");d.style.width="70px";
d.style.margin="5px";d.innerHTML="Erase";d.title="Erase last item";d.addEventListener("click",function(){0<r.length&&(r.pop(),U())},!1);wb=n("input");wb.type="text";wb.style.width="150px";wb.style.margin="5px";wb.title="Enter your text here, then click where you want it";wb.value="Text input";N=e.annotate_defaults;null!=N&&(N=N.split(","),Dd.selectedIndex=parseInt(N[0],10),1<N.length&&(Cd.selectedIndex=parseInt(N[1],10)),2<N.length&&(mc.selectedIndex=parseInt(N[2],10)),3<N.length&&(wb.value=N[3].trim()));
N=n("div");N.innerHTML="Annotation Tools";var p=n("div");p.appendChild(Dd);p.appendChild(Cd);var m=n("div");m.appendChild(mc);m.appendChild(d);d=n("div");d.appendChild(wb);ma.appendChild(N);ma.appendChild(p);ma.appendChild(m);ma.appendChild(d);B.appendChild(Xc);I.appendChild(ma)}"saveall"==h&&(je=n("button"),D&&(je.className="saveall"),ha(je,"saveall","SaveAll","SaveAll",K),vg=e.saveall_prompt,Qb=e.saveall_filename,d=e.saveall_list,wg=null==d?["0"]:d.split(","),je.addEventListener("click",function(){for(var a=
0;a<wg.length;a++)for(var b=parseInt(wg[a],10),c=0;c<ra.length;c++){0===c&&null!=vg&&(Qb=window.prompt(vg,Qb),null!=Qb&&1>Qb.length&&(Qb=null));var d=null==Qb?"":-1!=Qb.indexOf("#")?Qb.replace("#",c.toString()):Qb+c;var f=document.createElement("a");f.href=0==b?ra[c]:oa[c][b-1];f.download=d;d=new MouseEvent("click");f.dispatchEvent(d)}},!1),B.appendChild(je));if("capture"==h){ke=n("button");D&&(ke.className="capture");ha(ke,"capture","Capture","Capture",K);var t=e.capture_prompt;$e=e.capture_filename;
null==$e&&($e="haimage.png");ke.addEventListener("click",function(){var a=$e;if(null!=t&&(a=window.prompt(t,a),null==a))return;var b=n("canvas");b.height=qb.height;b.width=qb.width;var c=b.getContext("2d");Ad=!1;U();c.drawImage(qb,0,0);c.drawImage(Yb,0,0);Ad=!0;b.toBlob(function(b){var c=URL.createObjectURL(b),d=document.createElement("a");d.href=c;d.download=a;c=new MouseEvent("click");d.dispatchEvent(c);setTimeout(function(){URL.revokeObjectURL(b)},3E4)})},!1);B.appendChild(ke)}"show"==h&&(le=n("button"),
D&&(le.className="show"),ha(le,"show","Show","Show",K),af=e.show_prompt,bh=e.show_image_file,null==af&&(af="Right-click to save or copy the image<br> <font size='-1'>(to save in some browsers, you may need to first 'Open in New Tab')</font> <p>"),le.addEventListener("click",function(){if(bh)window.open(ra[w]);else{var a=qb.toDataURL("image/png;base64;");var b=window.open();b.document.write(af+"<img src="+a+"></img>")}},!1),B.appendChild(le));"toggle"==h&&(Fa=[],d=e.toggle_size,null!=d?(d=d.split(","),
Zc=parseInt(d[0],10),me=parseInt(d[1],10),ne=parseInt(d[2],10)):(me=Zc=10,ne=3),xg="red",yg="blue",zg="orange",Ag=!1,M(e.toggle_layout_width,"t")&&(Ag=!0),d=e.toggle_colors,null!=d&&(d=d.split(","),yg=d[0].trim(),xg=d[1].trim(),zg=d[2].trim()),ob=n("div"),ob.setAttribute("style","position:relative;border:0px;margin:0px;padding:0px;-webkit-user-select:none; -moz-user-select:none; -ms-user-select:none; user-select:none; -webkit-tap-heightlight-color:transparent;"),ob.style.backgroundColor=B.style.backgroundColor,
ob.align=ed,Bg=new PEvs(ob,null,null,null,null,HAniS.togclick,null),Gc=n("canvas"),Gc.height=2*me,bf=Gc.getContext("2d"),ob.appendChild(Gc),c?I.insertBefore(ob,db):I.appendChild(ob),d=e.toggle_onoff,oe=null,null!=d&&(oe=d.split(",")),cf=!0,null!=K&&(ob.title=K));if("overlay"==h){z=[];h=e.overlay_tooltip;K=null;null!=h&&(K=h.split(","));h=e.overlay_radio;d=null;null!=h&&(d=h.split(","));p=e.overlay_labels_color;N=null;null!=p&&(N=p.split(","));yd=[];m=e.overlay_caching;p=null;null==m&&(m=e.overlay_static);
null!=m&&(p=m.split(","));var x=!0;null!=e.overlay_nonewdiv&&(x=!1);for(m=0;m<Fb.length;m++){var A=Fb[m].trim();if(0==m||0==A.indexOf("/"))0==A.indexOf("/")&&(A=A.substr(1)),x?(xb=n("div"),Cg++,xb.align="center",c?I.insertBefore(xb,db):I.appendChild(xb)):(xb=n("span"),B.appendChild(xb)),g=e.overlay_labels_style,null!=g&&xb.setAttribute("style",g);var q=!1;g=A.length;0<A.indexOf("/on")&&A.indexOf("/on")==g-3&&(q=!0,A=A.substr(0,g-3));var u=!1;0<A.indexOf("/always")&&A.indexOf("/always")==g-7&&(u=q=
!0);var y=!1;0<A.indexOf("/hidden")&&(y=!0);var E=!1;0<A.indexOf("/hotspots")&&(E=!0,A=A.substr(0,A.indexOf("/")));null!=p?M(p[m],"y")||M(p[m],"t")?yd[m]=!0:yd[m]=!1:yd[m]=!0;z[m]=n("input");z[m].type="checkbox";z[m].value=A;z[m].id=A;z[m].showMe=!(u&y)&!E;var C="vertical-align:middle;";g=e.checkbox_style;null!=g&&(C+=g);z[m].setAttribute("style",C);z[m].checked=q;z[m].name=0;z[m].hotspotIndex=E;null!=wa&&m==Zb&&z[m].checked&&(wa.disabled=!1);null!=$b&&!$b[m]&&q&&(Lc=!1);z[m].addEventListener("click",
HAniS.overClick,!1);null!=h&&(g=d[m].indexOf("/"),-1!=g&&(z[m].name=d[m].substr(g+1).trim()),-1!=d[m].indexOf("true")&&(z[m].type="radio",-1==g&&(z[m].name="all")));z[m].isGhost=!0;u||y||(null!=K&&(z[m].title=K[m]),g=n("label"),g.htmlFor=A,null!=K&&(g.title=K[m]),g.innerHTML=A,g.name=z[m].name,A="vertical-align:middle;",null!=N&&(A=A+"color:"+N[m]+";"),g.setAttribute("style",A),A=n("span"),u="10",null!=Vd&&(u=10+Vd[m]),A.setAttribute("style","margin-left:"+u+"px;"),A.appendChild(z[m]),A.appendChild(g),
xb.appendChild(A),z[m].isGhost=!1)}if(null==Gb)for(Gb=Array(Fb.length),m=0;m<Fb.length;m++)Gb[m]=0;else for(m=0;m<Fb.length;m++)ab(m)}}Pb=!0;g=e.start_looping;null!=g&&M(g,"f")&&(Pb=!1,d=g.split(","),1<d.length&&(w=Dg=parseInt(d[1],10)-1));ea(Pb)}function ab(b){var c;if(0>Gb[b]){var a=!1;for(c=0;c<Fb.length;c++)Gb[c]!=-Gb[b]||a||(a=z[c].checked);z[b].checked=a}}function Ic(b){0==kb&&(fc=[]);b=b.substr(b.indexOf("=")+1).trim().split(",");var c=b[4].trim(),a=b[4].indexOf("/"),d=b[4].indexOf("?"),f=
-1,e=-1;-1!=a&&(f=parseInt(b[4].substring(a+1),10)-1,c=c.substring(0,a));-1!=d&&(e=parseInt(b[4].substring(d+1),10)-1,d<a||-1==a)&&(c=c.substring(0,d));fc[kb]=new Vb(parseInt(b[0].trim(),10),parseInt(b[1].trim(),10),b[2].trim(),b[3].trim(),c.toLowerCase(),b[5].trim().toLowerCase(),b[6].trim(),f,e,8==b.length?b[7].trim():null);kb+=1}function Md(b){0==ge&&(Ea=[],ka=null);var c=b.substr(b.indexOf("=")+1).trim().split("(");b=c[0].split(",");var a=b[0].trim();0==a.indexOf("0x")&&(a="#"+a.substring(2));
Ea[ge]=new Od(a,b[1].trim(),b[2].trim(),b[3].trim(),c[1].trim());ge+=1}function Nd(b){0==ib&&(ya=[]);b=b.substr(b.indexOf("=")+1).trim().split(",");ya[ib]=new oc(parseInt(b[0],10)-1,parseInt(b[1],16),b[2].trim(),b[3].trim(),5==b.length?b[4].trim():"Click for details");ib+=1}function Od(b,c,a,d,f){this.color=b;this.alpha=1;7<this.color.length&&(this.alpha=parseInt(this.color.substring(7),16)/255,this.color=this.color.substring(0,7),.1>this.alpha&&(this.alpha=.1));this.action=c;this.value=a;this.tip=
d;this.poly=f;b=f.split(",");this.xy=[];this.ymin=this.xmin=9999;for(c=this.ymax=this.xmax=0;c<b.length;c++)this.xy[c]=parseInt(b[c].trim(),10),0==c%2?(this.xy[c]<this.xmin&&(this.xmin=this.xy[c]),this.xy[c]>this.xmax&&(this.xmax=this.xy[c])):(this.xy[c]<this.ymin&&(this.ymin=this.xy[c]),this.xy[c]>this.ymax&&(this.ymax=this.xy[c]));this.height=this.ymax-this.ymin+1;this.width=this.xmax-this.xmin+1;this.can=n("canvas");this.can.height=this.height;this.can.width=this.width;this.ctx=this.can.getContext("2d");
this.ctx.imageSmoothingEnabled=!1;this.ctx.fillStyle=this.color;this.ctx.globalAlpha=this.alpha;this.ctx.beginPath();this.ctx.moveTo(this.xy[0]-this.xmin,this.xy[1]-this.ymin);for(c=2;c<this.xy.length;c+=2)this.ctx.lineTo(this.xy[c]-this.xmin,this.xy[c+1]-this.ymin);this.ctx.closePath();this.ctx.fill()}function oc(b,c,a,d,f){this.overlay=b;this.color=c;this.action=a;this.value=d;this.tip=f}function Vb(b,c,a,d,f,e,k,h,g,l){this.x0=b;this.y0=c;this.icon=null;this.isIcon=!1;"icon"==a?(this.icon=new Image,
this.icon.hotspot=this,df=!0,this.icon.onload=function(a){this.gotit=!0;this.hotspot.x1=this.hotspot.x0+this.width;this.hotspot.y1=this.hotspot.y0+this.height;this.hotspot.width=this.width;this.hotspot.height=this.height;this.hotspot.w2=this.width/2;this.hotspot.h2=this.height/2;this.hotspot.isIcon=!0;this.hotspot.origX=0;this.hotspot.origY=0},this.y1=this.x1=-1,this.icon.gotit=!1,this.icon.src=d.trim()):"sprite"==a?(this.x0=b,this.y0=c,this.inx=parseInt(d,10)-1,null!=xa&&this.inx>=sd&&this.inx<=
sd+xa.length?(this.inx-=sd,this.x1=xa[this.inx].width+b,this.y1=xa[this.inx].height+c,this.width=xa[this.inx].width,this.height=xa[this.inx].height,this.w2=this.width/2,this.h2=this.height/2,this.origY=this.origX=0,this.icon=xa[this.inx].cloneNode(),this.anim=!0,this.icon.setAttribute("style","position:absolute;top:0px;left:0px;visibility:hidden;"),rb.appendChild(this.icon)):(this.x1=Db[this.inx]+b,this.y1=Eb[this.inx]+c,this.width=Db[this.inx],this.height=Eb[this.inx],this.w2=Db[this.inx]/2,this.h2=
Eb[this.inx]/2,this.origX=Ee[this.inx],this.origY=Fe[this.inx],this.icon=De),df=this.isIcon=!0,this.icon.gotit=!0):(this.width=parseInt(a,10),this.height=parseInt(d,10),this.x1=this.width+b,this.y1=this.height+c,this.w2=this.width/2,this.h2=this.height/2);this.pan=f;this.isPan=!1;"pan"===this.pan&&(this.isPan=!0);this.action=e;this.value=k;this.overlay=h;this.frame=g;this.tip=l}function pc(){if(Ed){ua=-1;for(var b=0;b<Za.length;b++)P>=Za[b]&&(ua=b)}}function Bb(b,c){"popup"==b.action?(null!=ef&&ef.close(),
ef=window.open("","HAniSPopup","scrollbars=yes,width="+Xf+",height="+Wf),ef.document.write(Vf+b.value+"</div>")):"link"==b.action?(b=b.value,null!=Na&&(pa=Na.toLatLon(aa,ba),b=b.replace("%LATITUDE%",pa[0].toFixed(4)),b=b.replace("%LONGITUDE%",pa[1].toFixed(4))),window.open(b,"_blank","")):"fof"==b.action&&(da=Rf,HAniS.resetZoom(),HAniS.newFOF(b.value,!0),ye(c))}function Jc(b){b?(P-=.1*md/q,S-=.1*md/x):(P+=.1*md/q,S+=.1*md/x,P>nd&&(P=nd),S>nd&&(S=nd));P<=ff||S<=pe?(P=ff,S=pe,aa=u,ba=p,E=J=0,Aa=X,Oa=
ia,Zd=Pc=0,Sc&&(Xa=!0)):(J=aa-u/P,E=ba-p/S,Aa=Math.floor(X/S),E+Aa>X-Pc&&(E=X-Pc-Aa),Oa=Math.floor(ia/P),E=Math.round(E),J=Math.round(J),Pc=Tf,Zd=Uf,Sc&&(Xa=!1));pc()}function qc(){qe=0;yb=Array(2);pb=Array(2);$c=Array(2);Ha=0;Oc=null;Ba(qa(0))}function ea(b){Ya=!b;HAniS.toggleIsLooping()}function Pd(b,c,a,d,f,e){vd.clearRect(0,0,W,Y);vd.imageSmoothingEnabled=gd;y.imageSmoothingEnabled=gd;vd.drawImage(b,c,a,d,f,0,0,W,Y);Eg=vd.getImageData(0,0,W,Y);Hc=Eg.data;gf=Ka[e];hf=La[e];jf=Ma[e];kf=rd[e];ch=
4*W*Y;for(Rb=0;Rb<ch;Rb+=4)Qa=Hc[Rb],Qa===Hc[Rb+1]&&Qa===Hc[Rb+2]&&(Hc[Rb]=gf[Qa],Hc[Rb+1]=hf[Qa],Hc[Rb+2]=jf[Qa],Hc[Rb+3]=kf[Qa]);vd.putImageData(Eg,0,0);y.drawImage(ce,0,0,W,Y)}function H(b,c,a){null!=b&&(c?(null!=b.style_on&&b.setAttribute("style",b.style_on),b.innerHTML=b.label_on):(null!=b.style_off&&b.setAttribute("style",b.style_off),b.innerHTML=b.label_off),D&&(b.className=a))}function cb(b,c){if(!(b>=v)&&(-2==Fa[b]&&(c=-2),Fa[b]=c,Re&&1==c&&(jb.value=b+1,Bd.innerHTML=he.replace("*",b+1)),
cf)){b=Fg+b*(Zc+ne);var a=zg;0==c?a=yg:-1==c?a=xg:-2==c&&(a=Cf);bf.fillStyle=a;bf.fillRect(b,me/2,Zc,me)}}function dd(b,c){cf&&(Gc.width=Ag?parseInt(I.style.width,10):W,bf.clearRect(0,0,Gc.width,Gc.height),Fg=Gc.width/2-b*(Zc+ne)/2);for(var a=0;a<b;a++)c?-1!=id?cb(a,-2):null!=oe&&"n"==oe[a].toLowerCase().trim()?cb(a,-1):cb(a,0):cb(a,Fa[a])}function Ba(b){cb(w,0);w=b;cb(w,1);null!=Ga&&null!=Pa&&null!=Pa[w]&&(Ga.innerHTML=Pa[w])}function qa(b){b>=v&&(b=v-1);if(0<=Fa[b])return b;var c=-1,a=b;0==a&&(c=
1);for(var d=0;d<v-1;d++)if(a+=c,0<=Fa[a])return a;return b}function bb(b){cb(w,0);var c=b;do 0<c?(c=qa(v-1),w+=1,w>c&&(Fd&&Ya?(w=c,b=-b):w=qa(0))):(c=qa(0),--w,w<c&&(Fd&&Ya?(w=c,b=-b):w=qa(v-1))),c=b;while(0>Fa[w]);Xe=c;cb(w,1);null!=Ga&&null!=Pa&&null!=Pa[w]&&(Ga.innerHTML=Pa[w])}function Sa(b,c,a,d,f,e,k){this.bg=b;null!=b&&0==this.bg.indexOf("0x")&&(this.bg="#"+this.bg.substring(2));this.fg=c;null!=c&&0==this.fg.indexOf("0x")&&(this.fg="#"+this.fg.substring(2));this.font=a;this.fontHeight=Math.round(1.1*
parseInt(a,10));this.scolor=d;null!=d&&0==this.scolor.indexOf("0x")&&(this.scolor="#"+this.scolor.substring(2));this.sblur=f;this.sxoff=e;this.syoff=k}function Ja(b,c,a,d,f){k.globalAlpha=1;k.font=b.font;var e=b.fontHeight;a=a-e-6;var g=k.measureText(d).width;1==f&&(c-=g);0==f&&(c-=g/2);5>c&&(c=5);5>a&&(a=5);a+e+3>Y&&(a=Y-e-6);c+3+g>W&&(c=W-g-6);k.save();k.beginPath();k.fillStyle=b.bg;null!=b.scolor&&(k.shadowColor=b.scolor,k.shadowBlur=b.sblur,k.shadowOffsetX=b.sxoff,k.shadowOffsetY=b.syoff);re=
c-3;lf=a;Gg=g+6;mf=e+6;k.fillRect(re,lf,Gg,mf);k.closePath();k.restore();k.textBaseline="bottom";k.fillStyle=b.fg;k.fillText(d,c,a+e+3)}function U(){k.clearRect(0,0,W,Y);nf=!1;if(Ra){k.beginPath();k.lineWidth=2;k.strokeStyle="white";var b=Ha;1<b&&(b=2);for(var c=0;c<b;c++)1<Ha&&(k.moveTo(yb[0]/q,pb[0]/x),k.lineTo(yb[1]/q,pb[1]/x)),k.moveTo(yb[c]/q-15,pb[c]/x),k.lineTo(yb[c]/q+15,pb[c]/x),k.moveTo(yb[c]/q,pb[c]/x-15),k.lineTo(yb[c]/q,pb[c]/x+15);k.closePath();k.stroke();if(3==Ha){var a=L,d=G;k.moveTo(a,
d);k.fillStyle=ac;k.fillRect(a-2,d-2,5,5);b=ad;c=Math.round(a+se/q*Gd*(ad-$c[1]));for(var f=Math.round(d+Hd/x*Gd*(ad-$c[1])),e=0;300>e;e++){k.beginPath();k.lineWidth=1;k.strokeStyle=ac;k.moveTo(a,d);k.lineTo(c,f);k.stroke();k.beginPath();k.lineWidth=3;k.rect(c-2,f-2,5,5);k.stroke();if(3>c||c+3>W||3>f||f+3>Y)break;d=Lb+b;d=100*Math.floor(d/60)+d%60;d%=2400;Mf?(a="AM",1200<=d?(1300<=d&&(d-=1200),a="PM"):100>d&&(d+=1200),a=Math.floor(d/100)+":"+Math.floor(Math.floor(d%100)/10)+Math.floor(d%10)+" "+a):
(a=d+" ",1E3>d&&(a="0"+d),100>d&&(a="00"+d),10>d&&(a="000"+d));d=0;Math.abs(of)<Nc+5&&(d=45*.0174533);var g=f;0>Hg*of&&0==d&&(g=f+Nc);k.font=kd;a=a+" "+Lf;var h=k.measureText(a).width;k.fillStyle=jd;0===d?(k.fillRect(c+2,g-Nc-2+d,h+4,Nc+3),k.fillStyle=ac,k.textBaseline="bottom",k.fillText(a,c+5,g)):(k.save(),k.translate(c+5,f),k.rotate(d),k.fillRect(2,-2,h+4,Nc+3),k.fillStyle=ac,k.textBaseline="bottom",k.fillText(a,5,Nc),k.restore());a=c;d=f;c=Math.round(a+Gd*Hg);f=Math.round(d+Gd*of);b+=R}}null!=
Oc&&Ja(Je,dh,eh,Oc,0);Ad&&(Ja(Xg,9999,bg,ag[qe],0),Ig=re,Jg=lf,Kg=lf+mf)}if(lb){Ad&&(0==Wc?Ja(pg,9999,10,$d[0],0):(Ja($g,10,10,$d[1],0),fh=re+Gg,Ja(pg,9999,10,$d[2],0)),gh=re,hh=mf);k.beginPath();k.lineWidth=2;k.strokeStyle=cg;for(b=0;b<ja.length;b+=2)0==b?k.moveTo(ja[b]/q,ja[b+1]/x):k.lineTo(ja[b]/q,ja[b+1]/x);4<ja.length&&k.lineTo(ja[0]/q,ja[1]/x);k.stroke();for(b=0;b<ja.length;b+=2)k.beginPath(),k.rect(ja[b]/q-2,ja[b+1]/x-2,5,5),k.stroke()}if(Yc)for(b=0;b<r.length;b++){c=r[b].type;k.beginPath();
k.strokeStyle=r[b].color;k.lineWidth=r[b].width;if("0"==c)c=Math.atan2(r[b].xe-r[b].x,r[b].ye-r[b].y),f=r[b].x+r[b].width*Math.sin(c),e=r[b].y+r[b].width*Math.cos(c),k.beginPath(),k.moveTo(f,e),k.lineTo(r[b].xe,r[b].ye),a=12+r[b].width/5,k.moveTo(f+a*Math.sin(c-.523599),e+a*Math.cos(c-.523599)),k.lineTo(f,e),k.lineTo(f+a*Math.sin(c+.523599),e+a*Math.cos(c+.523599));else if("1"==c)k.arc(r[b].x,r[b].y,r[b].size,0,2*Math.PI);else if("2"==c)k.rect(r[b].x-r[b].size,r[b].y-r[b].size,2*r[b].size,2*r[b].size);
else if("3"==c){k.moveTo(r[b].xp[0],r[b].yp[0]);for(f=1;f<r[b].xp.length;f++)k.lineTo(r[b].xp[f],r[b].yp[f]);k.lineTo(r[b].xp[0],r[b].yp[0])}else if("4"==c)for(k.moveTo(r[b].xp[0],r[b].yp[0]),f=1;f<r[b].xp.length;f++)k.lineTo(r[b].xp[f],r[b].yp[f]);else"5"==c&&(k.fillStyle=r[b].color,k.font=r[b].width+"pt arial",c=k.measureText(r[b].text).width,k.fillText(r[b].text,r[b].x-c/2,r[b].y+r[b].width/2));k.stroke()}Dc&&(b=rc*(te-Id)/P,c=Sd*(ue-Jd)/S,b=" "+Math.sqrt(b*b+c*c).toFixed(yf)+" "+xf+" ",Ja(Vg,
Id/q,Jd/x,b,-1),k.beginPath(),k.strokeStyle=zf,k.lineWidth=3,k.moveTo(te/q,ue/x),k.lineTo(Id/q,Jd/x),k.stroke(),k.closePath());sb&&Ja(Qf,Lg,Mg,Ng,-1);if(Fc||Uc)if(L=la.getX(),u=L*q,G=la.getY(),p=G*x,0<=u&&0<=p){aa=J+u/P;ba=E+p/S;if(Uc){null!=Na?pa=Na.toLatLon(aa,ba):(pa[0]=ud+(hg-ud)*ba/X,pa[1]=be+(ig-be)*aa/ia);ih=uf+pa[0].toFixed(Be)+"  "+vf+pa[1].toFixed(Be);b=G;if(Dc||sb)b=G+wf.fontHeight+6;Ja(wf,L+10,b,ih,-1)}if(Fc)if(aa=Math.round(aa),ba=Math.round(ba),Ze)Ia.clearRect(0,0,1,1),Ia.drawImage(za[w],
aa,ba,1,1,0,0,1,1),F=Ia.getImageData(0,0,1,1).data,Q=0,Cb(!1);else for(b=0;b<na;b++)if(c=na-b-1,C[w][c].gotit&&z[c].checked&&(c==Zb||null!=uc[c]&&0<=uc[c])){Ia.clearRect(0,0,1,1);c==Zb?Ia.drawImage(Mb[w],aa,ba,1,1,0,0,1,1):Ia.drawImage(C[w][c],aa,ba,1,1,0,0,1,1);F=Ia.getImageData(0,0,1,1).data;Q=uc[c];Cb(c==Zb||fg);break}}!Xa||Ra||Xb||Fc||null==ka||(k.drawImage(ka.can,0,0,ka.width,ka.height,ka.xmin/q,ka.ymin/x,ka.width/q,ka.height/x),Ja(Qf,(ka.xmin+ka.xmax)/2/q,(ka.ymin+ka.ymax)/2/x,ka.tip,0),nf=
!0)}function Cb(b){ve=999;nc=ng;var c=gb[Q].length-1;if(0==F[3])nc=ae[Q];else{if(og)Sb=F[0];else if(b)pf=0,Sb=F[0],ve=0;else for(var a=0;a<c;a++)Tb[0]=F[0]-Ka[Q][a],0>Tb[0]*(Ka[Q][a+1]-F[0]-1)||(Tb[1]=F[1]-La[Q][a],0>Tb[1]*(La[Q][a+1]-F[1]-1)||(Tb[2]=F[2]-Ma[Q][a],0>Tb[2]*(Ma[Q][a+1]-F[2]-1)||(bd=Oe[Q][a],qf=Tb[bd]/Bc[Q][a][bd],Og=Math.abs(Tb[Pg[bd]]-qf*Bc[Q][a][Pg[bd]])+Math.abs(Tb[Qg[bd]]-qf*Bc[Q][a][Qg[bd]]),Og<ve&&(Sb=a,ve=Og,pf=qf))));if(999>ve)nc=Ac[Q][Sb],-1!=Ib[Q][Sb]&&(Rg=gb[Q][Sb],0!=pf&&
(Rg+=pf*(gb[Q][Sb+1]-gb[Q][Sb])),nc=nc+" "+Rg.toFixed(Ib[Q][Sb])+" "+zc[Q][Sb]);else if(b||0<zd){var d=-1;if(b)d=F[0];else for(a=0;a<c;a++)if(Math.abs(F[0]-Ka[Q][a])<zd&&Math.abs(F[1]-La[Q][a])<zd&&Math.abs(F[2]-Ma[Q][a])<zd){d=a;break}-1!=d&&(nc=Ac[Q][d],-1!=Ib[Q][d]&&(nc=nc+" "+gb[Q][d].toFixed(Ib[Q][d])+" "+zc[Q][d]))}}Ja(Wg,L-10,G,nc,1)}function l(){if(Ue)try{y.clearRect(0,0,W,Y);y.globalAlpha=1;if(Ed&&null!=Nb&&0<=ua&&Nb[ua].gotit)y.drawImage(Nb[ua],J*Za[ua],E*Za[ua],Oa*Za[ua],Aa*Za[ua],0,0,
W,Y);else if(za[w].gotit&&(null!=Ge?Pd(za[w],J,E,Oa,Aa,Ge):y.drawImage(za[w],J,E,Oa,Aa,0,0,W,Y)),null!=va&&(y.globalAlpha=1,za[w].gotit))for(var b=0;b<va.length;b+=4)y.drawImage(za[w],va[b],va[b+1],va[b+2],va[b+3],va[b]/q,va[b+1]/x,va[b+2]/q,va[b+3]/x);if(0<na){for(b=0;b<na;b++){var c=null!=wc?wc[b]:b;z[c].checked&&z[c].showMe&&(Ed&&null!=Ob&&0<=ua&&Ob[ua].gotit&&Sg==c?y.drawImage(Ob[ua],J*Za[ua],E*Za[ua],Oa*Za[ua],Aa*Za[ua],0,0,W,Y):C[w][c].gotit&&(null!=Wd&&(y.globalAlpha=Wd[c]),null==xc||1===xc[c]?
null!=tc&&0<=tc[c]?Pd(C[w][c],J,E,Oa,Aa,tc[c]):y.drawImage(C[w][c],J,E,Oa,Aa,0,0,W,Y):0===xc[c]&&y.drawImage(C[w][c],0,0,ia,X,0,0,W,Y)))}if(null!=eb)for(y.globalAlpha=1,b=0;b<na;b++)c=null!=wc?wc[b]:b,C[w][c].gotit&&(Kf[c]||z[c].checked)&&eb[c]&&y.drawImage(null!=C[w][c].origImage?C[w][c].origImage:C[w][c],Z[c][0],Z[c][1],Z[c][2],Z[c][3],Z[c][4]/q,Z[c][5]/x,Z[c][2]/q,Z[c][3]/x);Fc&&U()}mg&&Qd();if(df)for(y.globalAlpha=1,c=0;c<kb;c++){var a=fc[c];null!=a.icon&&(a.icon.style.visibility="hidden");if((-1==
a.frame||a.frame==w)&&null!=a.icon&&a.icon.gotit&&(-1==a.overlay||-1!=a.overlay&&z[a.overlay].checked)){if(a.isPan){var d=Math.round(((a.x0-J)*P-a.w2)/q);var f=Math.round(((a.y0-E)*S-a.h2)/x);a.anim?(a.icon.style.top=f+"px",a.icon.style.left=d+"px"):y.drawImage(a.icon,a.origX,a.origY,a.width,a.height,d,f,a.width/q,a.height/x)}else y.drawImage(a.icon,a.origX,a.origY,a.width,a.height,a.x0/q,a.y0/x,a.width/q,a.height/x);a.icon.style.visibility="visible"}}}catch(ca){fa("Error:"+ca)}}function Qd(){if(Le&&
ec>Wa){y.save();y.fillStyle="blue";y.strokeStyle="white";y.lineWidth=3;y.strokeRect(de,ee,200,14);y.fillRect(de,ee,Wa/ec*200,14);var b=y.measureText("Loading images").width;y.fillStyle="orange";y.font="14px arial";y.fillText("Loading images",de+100-b/2,ee+11);y.restore()}else mg=!1,Ae&&(Wb.style.visibility="hidden");Wa>=ec&&!Ya&&Ba(qa(w))}function fa(b){if(Rd&&ze&&!ze.closed)try{ze.document.write(b+"<br>")}catch(c){}}function Zg(){Ya&&bb(Xe);jh=w==qa(v-1)?Af+Ta:Ta;l();setTimeout(function(){oh(Zg)},
jh)}function we(b){for(;-180>b;)b+=360;for(;180<b;)b-=360;return b}function mh(){var b,c,a,d,f,e,k,h,g=Math.PI/180;this.init=function(a){for(var d=[],h=1;h<a.length;h++)d[h]=parseFloat(a[h]);c=d[1];b=d[4]/d[5];f=d[6];e=d[7];a=this.toXY(d[2],d[3]);f=a[0];e=a[1]};this.toXY=function(h,k){a=b*we(k-c)*g-f;d=-b*h*g-e;return[a,d]};this.toLatLon=function(a,d){k=-(d+e)/b/g;h=we((a+f)/b/g+c);return[k,h]}}function lh(){var b,c,a,d,f,e,k,h,g,l,p,m,r,n,A,t,x,v,w,u,q,z,B,y,E,C,G,H,I,J,F,D=Math.PI/180;this.init=
function(a){for(var d=[],f=1;f<a.length;f++)d[f]=parseFloat(a[f]);b=d[1];c=d[2];u=0==d[8]?!1:!0;q=d[6];z=q*q;B=z*z;y=B*z;E=B*B;k=d[5]/d[7];F=d[7];u?(h=Math.cos(D*b),g=Math.sin(D*b)):(h=Math.cos(-b*D),g=Math.sin(-b*D));x=h/Math.sqrt(1-z*g*g);w=(1-q*g)/(1+q*g);t=u?Math.tan(Math.PI/4-b*D/2)/Math.pow(w,q/2):Math.tan(Math.PI/4- -b*D/2)/Math.pow(w,q/2);n=d[9];A=d[10];a=this.toXY(d[3],d[4]);n=a[0];A=a[1]};this.toXY=function(h,g){u?(f=D*h,e=D*(g-c)):(f=D*-h,e=D*(c-g));w=(1-q*Math.sin(f))/(1+q*Math.sin(f));
v=Math.tan(Math.PI/4-f/2)/Math.pow(w,q/2);C=90!=b&&-90!=b?k*x*v/t:2*k*F*v/Math.sqrt(Math.pow(1+q,1+q)*Math.pow(1-q,1-q));a=C*Math.sin(e);d=C*Math.cos(e);u||(a=-a,d=-d);l=a-n;p=d-A;return[l,p]};this.toLatLon=function(e,h){a=e+n;d=h+A;C=Math.sqrt(a*a+d*d);v=90==b||-90==b?C*Math.sqrt(Math.pow(1+q,1+q)*Math.pow(1-q,1-q))/(2*k*F):C*t/(k*x);G=Math.PI/2-2*Math.atan(v);H=Math.sin(2*G);I=Math.sin(4*G);J=Math.sin(6*G);f=G+H*z/2+5*H*B/24+H*y/12+13*H*E/360+7*I*B/48+29*I*y/240+811*I*E/11520+7*J*y/120+81*J*E/1120+
4279*Math.sin(8*G)*E/161280;u?(m=f/D,r=Math.atan2(a,d)/D+c):(m=-f/D,r=-Math.atan2(-a,-d)/D+c);return[m,we(r)]}}function nh(){var b,c,a,d,f,e,g,h,k,l,p,m,n,q,r,t,u,v,w,x,z,B,E,y,C,D,G,H,I,J,F,Q,O,M,P,L=Math.PI/180;this.init=function(d){for(var f=[],e=1;e<d.length;e++)f[e]=parseFloat(d[e]);b=f[1];c=f[2];a=f[3];y=f[7];C=y*y;D=C*C;G=D*C;H=D*D;h=f[6]/f[8];k=Math.cos(L*b);l=Math.cos(L*c);m=Math.sin(b*L);p=Math.sin(c*L);z=k/Math.sqrt(1-C*m*m);B=l/Math.sqrt(1-C*p*p);w=Math.sqrt((1-m)/(1+m)*Math.pow((1+y*
m)/(1-y*m),y));x=Math.sqrt((1-p)/(1+p)*Math.pow((1+y*p)/(1-y*p),y));F=(Math.log(z)-Math.log(B))/(Math.log(w)-Math.log(x));Q=z/(F*Math.pow(w,F));M=h*Q*Math.pow(w,F);u=f[9];v=f[10];d=this.toXY(f[4],f[5]);u=d[0];v=d[1]};this.toXY=function(b,c){e=L*b;g=L*we(c-a);P=Math.sin(e);E=Math.sqrt((1-P)/(1+P)*Math.pow((1+y*P)/(1-y*P),y));J=h*Q*Math.pow(E,F);O=F*g;d=J*Math.sin(O);f=M+J*Math.cos(O);n=d-u;q=f-v;return[n,q]};this.toLatLon=function(b,c){d=b+u;f=c+v;J=Math.abs(F)/F*Math.sqrt(d*d+(M-f)*(M-f));E=Math.pow(J/
(h*Q),1/F);I=Math.PI/2-2*Math.atan(E);O=0>F?Math.atan(-d/(f-M)):Math.atan(d/(M-f));g=O/F;e=I+(C/2+5/24*D+G/12+13/360*H)*Math.sin(2*I)+(7/48*D+29/240*G+811/11520*H)*Math.sin(6*I)+(7/120*G+81/1120*H)*Math.sin(6*I)+4279/161280*H*Math.sin(8*I);r=e/L;t=we(a-g/L);return[r,t]}}var Bf,Y,W,X,ia,q,x,dg,eg,mb,nb,Wb,Ae,la,Rd,ef,ze,ic,He=!1,I,B,Ve,We,db,rb,qb,y,Ia,Yb,k,v,ra,na,oa,Fb,wc,Gb,Yd,da,Rf,za,C,z,Wd,yd,sb,Ng,Lg,Mg,Mc,hd,Df,Ca,Ef,rf,Tg,L,G,u,p,aa,ba,Oa,Aa,J,E,Ad,D,Dg,Yg,Ya,Pb,w,Xe,Fd,td,Qc=!0,Ud,sf,e,Ta,
Hb,yc,Me,Af,jh,gd,wa,Rc,vc,Zb,Da,Mb,Cc,xd,Se,fe,Ge,ce,vd,Eg,Hc,Qa,gf,hf,jf,kf,ch,Rb,tc,Fa,Zc,me,ne,Ag,ob,Fg,Bg,xg,yg,zg,id,Cf,fc,kb,df,Ke,gg,xa,sd,jg,ib,ya,F,tf,Ea,ge,Xa,Sc,Te,wd,ka,nf,$b,Lc,Za,ua,Nb,gc,Ob,hc,Ed,Pa,Ga,Sg,cf,oe,Gc,bf,Ue,Kc,hb,Va,Ua,vb,Kb,Jb,Vd,jc,lb,Wc,$d,Ne,cg,ja,$g,pg,gh,fh,hh,tb,Ra,Ha,yb,pb,$c,Ig,ag,Jg,Kg,bg,Xg,fb,Gd,se,Hd,Ug,od,Qe,Hg,of,ad,R,qe,Lb,Xd,Lf,ac,jd,kd,Nc,Mf,Nf,bh,le,af,ke,$e,Xc,r,je,vg,Qb,wg,ma,Yc,sg,tg,lc,kc,ie,ah,Dd,Cd,mc,wb,qg,rg,ta,Sf,md,P,S,ff,pe,$f,cc,ld,Zf,Yf,
sa,nd,xe,Ff=!1,Gf,Hf,If,Ie,Jf,Tc,jb,he,Bd,Re,ub,Xb,te,ue,yf,Td,re,lf,Gg,mf,kg=!0,lg,Id,Jd,Vg,zf,Dc,rc,Sd,xf,Qf,Ec,Uc,Be,uf,vf,wf,Na,pa,ih,ud,be,hg,ig,va,xb,Cg,xc,eb,Z,Kf,qd,dc,Vf,Xf,Wf,uc,Fc,Ye,Vc,zc,Ac,Ib,bd,ve,Wg,ng,zd,og,Ze,Je,Of,Pf,Oc,dh,eh,Sb,pf,qf,Pg,Qg,Tb,Q,Og,nc,Rg,gb,t,Bc,fg,Ka,La,Ma,rd,Oe,ae,kh,fd,Ce,sc,Le,mg,de,ee,Wa,ec,Pc,De,Ee,Fe,Db,Eb,Tf,Zd,Uf,ed,bc,ph="N NNE NE ENE E ESE SE SSE S SSW SW WSW W WNW NW NNW N".split(" "),oh=window.requestAnimationFrame||window.mozRequestAnimationFrame||
window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(b){setTimeout(b,10)},n=function(b){return document.createElement(b)},M=function(b,c){if(null!=b)return 0==b.trim().toLowerCase().indexOf(c)},ug=function(b,c,a){var d=n("select");d.style.width="70px";d.style.margin="5px";for(var f=0;f<b.length;f++){var e=n("option");e.innerHTML=b[f];e.value=c[f];d.add(e)}d.addEventListener("change",a,!1);return d};HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,
"toBlob",{value:function(b,c,a){a=window.atob(this.toDataURL(c,a).split(",")[1]);for(var d=a.length,f=new Uint8Array(d),e=0;e<d;e++)f[e]=a.charCodeAt(e);b(new Blob([f],{type:c||"image/png"}))}});this.setup=function(b,c,a){void 0==c&&(c="MORdivcan");lg=a;I=document.getElementById(c);ed="center";I.align=ed;db=n("div");db.setAttribute("style","position:relative;border:0px;margin:0px;padding:0px;-webkit-user-select:none; -moz-user-select:none; -ms-user-select:none; user-select:none; -webkit-tap-heightlight-color:transparent;");
qb=n("canvas");qb.setAttribute("style","position:absolute;top:0;left:0;z-index:1;");Yb=n("canvas");Yb.setAttribute("style","position:absolute;top:0;left:0;z-index:2;");k=Yb.getContext("2d");k.imageSmoothingEnabled=!1;rb=n("div");rb.setAttribute("style","position:absolute;top:0;left:0;z-index:5;overflow:hidden;");ce=n("canvas");db.appendChild(qb);db.appendChild(Yb);db.appendChild(rb);I.appendChild(db);la=new PEvs(rb,HAniS.down,HAniS.up,HAniS.move,HAniS.drag,null,HAniS.canTip);I.setAttribute("tabindex",
0);I.addEventListener("keyup",function(a){sf=!1;a.preventDefault();a.stopPropagation()},!1);I.addEventListener("keypress",function(a){a.preventDefault();a.stopPropagation()},!1);I.addEventListener("keydown",function(a){a.preventDefault();a.stopPropagation();sf=a.ctrlKey?!0:!1;37==a.keyCode?(ea(!1),bb(-1),l()):39==a.keyCode?(ea(!1),bb(1),l()):32==a.keyCode?HAniS.toggleIsLooping():82==a.keyCode&&a.altKey&&HAniS.resetZoom()},!1);rb.addEventListener("mouseenter",function(a){I.focus()},!1);I.style.outlineWidth=
"0px";I.style.outline="none";I.focus();Dg=w=0;Fd=!1;Xe=1;Pb=Ya=!0;kb=na=v=0;Ud=!0;wc=null;td=!0;Ta=500;Hb=100;yc=2E3;Me=30;Af=0;Ce=6E4;sc=null;fd=!1;Rf=Yd=bc=da=null;pe=ff=S=P=1;xe=!1;E=J=Aa=Oa=ba=aa=p=u=G=L=0;$f=!1;Qc=kg=!0;cf=Ae=He=!1;id=-1;Fa=[];ib=0;df=!1;xa=null;sd=0;Ga=null;ee=de=Wa=ec=0;sb=Ke=Ue=fg=!1;te=ue=Id=Jd=0;Uc=Dc=Xb=!1;Na=null;pa=[0,0];Xa=Re=Td=!1;Lc=!0;ka=$b=null;lb=nf=!1;Ad=!0;ja=[];Fc=Ze=Ye=!1;Pg=[1,0,0];Qg=[2,2,1];Tb=[];uc=[];vc=Rc=Ra=!1;Xd=qe=0;xb=We=Ve=B=ob=null;Cg=0;sf=!1;c=
n("canvas");c.height=1;c.width=1;Ia=c.getContext("2d");Ia.imageSmoothingEnabled=!1;Te=n("canvas");Rd=!1;"string"===typeof b?0>b.indexOf("\n")?zb(b):g(b.split("\n")):g(b)};this.reloadFOF=function(){fa("reload FoF = "+sc);ye("r");Kc?HAniS.newFOF(kh,!1):(td=!0,cd())};this.getFOF=function(){var b=e.file_of_filenames.trim();HAniS.newFOF(null!=Yd?Yd+b:b,!0)};this.newFOF=function(b,c){var a,d,f,e,g=new XMLHttpRequest,h,k,l,p,m,n;jg=ib;var q=null;Ue=!1;Pb=Ya;ea(!1);c&&Ba(Dg);ib=v=0;ra=[];fc=null;kb=0;Ca=
Ea=null;Tg=[];for(rf=null;rb.hasChildNodes();)rb.removeChild(rb.lastChild);ge=0;Xa=Sc=!1;Za=null;Ed=!1;ua=-1;hc=Ob=gc=Nb=null;Sg=-1;oa=[];var r=!1;if(null==fb||null!=od)fb=[];fa("new FOF="+b);Ra&&(null!=tb&&(H(tb,!0,"extrap on"),I.style.cursor="default",ea(Pb),Ha=-1),Ra=!1,U());lb&&(null!=jc&&(H(jc,!0,"mark on"),I.style.cursor="default",ea(Pb),Wc=-1),lb=!1,U());g.onload=function(){var b=this.responseText.split("\n");for(a=0;a<b.length;a++)if(!(2>b[a].length)&&(h=b[a].trim(),fa("FOF: "+h),0!=h.indexOf("#")))if(0==
h.indexOf("frame_labels"))m=h.split("="),Pa=m[1].split(",");else if(0==h.indexOf("redirect"))for(m=h.split("="),n=m[1].split(","),rf=n[0].trim(),d=1;d<n.length;d++){var c=parseInt(n[d],10)-1;Tg[c]=!0}else if(0==h.indexOf("slice")){m=h.split("=");n=m[1].split(",");Ca=[];for(d=0;d<n.length;d++)Ca[d]=parseInt(n[d],10);Ca[2]=Ca[2]-Ca[0]+1;Ca[3]=Ca[3]-Ca[1]+1}else if(0==h.indexOf("fof_extension"))m=h.split("="),q=m[1].trim();else if(0==h.indexOf("image_base"))m=h.split("="),da=m[1].trim();else if(0==h.indexOf("overlay_base"))m=
h.split("="),bc=m[1].trim();else if(0==h.indexOf("high_res_basemap")){m=h.split("=");n=m[1].split(",");gc=[];for(d=0;d<n.length;d++)gc[d]=n[d].trim(),null!=da&&(gc[d]=da+gc[d]);Ed=!0}else if(0==h.indexOf("high_res_overlay")){m=h.split("=");n=m[1].split(",");Sg=parseInt(n[0].trim(),10)-1;hc=[];for(d=1;d<n.length;d++)hc[d-1]=n[d].trim(),null!=bc?hc[d-1]=bc+hc[d-1]:null!=da&&(hc[d-1]=da+hc[d-1]);Ed=!0}else if(0==h.indexOf("high_res_zoom")){m=h.split("=");n=m[1].split(",");Za=[];for(d=0;d<n.length;d++)Za[d]=
parseFloat(n[d].trim());pc()}else if(0==h.indexOf("hoverzone"))Md(h);else if(0==h.indexOf("hotzone"))Nd(h);else if(0==h.indexOf("hotspot"))Ic(h);else if(0==h.indexOf("toggle_onoff"))m=h.split("="),oe=m[1].split(",");else if(0==h.indexOf("coordinates"))m=h.split("="),O(m[1]);else if(0==h.indexOf("map_scale"))m=h.split("="),n=m[1].split(","),rc=parseFloat(n[0]),Sd=1<n.length?parseFloat(n[1]):rc;else if(0==h.indexOf("times")){m=h.split("=");n=m[1].split(",");for(a=0;a<n.length;a++)fb[a]=parseInt(n[a].trim(),
10);r=!0}else{null!=od&&(c=h.match(od),null!=c&&2==c.length?(fb.push(parseInt(c[1],10)),fa("+ + + Extrap time = "+c[1]),r=!0):fa("+ + + Cannot parse times using "+od+" from line: "+h));f=h.indexOf(" ");0>f&&(f=h.length);ra[v]=h.substring(0,f).trim();null!=da&&(ra[v]=da+ra[v]);h=h.substring(f+1);c=h.indexOf('"');0<=c&&(null==Pa&&(Pa=[]),f=h.substring(c+1),c=f.indexOf('"'),0<=c&&(Pa[v]=f.substring(0,c),0==v&&(Ga.innerHTML=Pa[0])));oa[v]=[];c=h.indexOf("overlay");if(0<=c)for(k=h.substring(c),c=k.indexOf("="),
0>c&&fa("Cannot find a = sign in "+k),l=k.substring(c+1),k=l.trim(),l=k.split(","),na=l.length,fa("numOverlays set to "+na),e=0;e<l.length;e++)oa[v][e]=l[e].trim(),null!=rf&&Tg[e]?oa[v][e]=(rf+oa[v][e]).trim():null!=bc?oa[v][e]=(bc+oa[v][e]).trim():null!=da&&(oa[v][e]=(da+oa[v][e]).trim());v+=1}r&&Kd(fb);null!=q?(b=new XMLHttpRequest,b.onload=function(){var b=this.responseText.split("\n");for(a=0;a<b.length;a++)2>b[a].length||(p=b[a].trim(),fa("ext_FOF: "+p),0!=p.indexOf("#")&&(0==p.indexOf("hotzone")?
Nd(p):0==p.indexOf("hotspot")&&Ic(p)));Ab()},b.onerror=function(){Ab()},b.open("get",q+"?"+Math.round(1E5*Math.random()),!0),b.send()):Ab()};kh=b;g.open("get",b+"?"+Math.round(1E5*Math.random()),!0);g.send()};this.setWindowSize=function(b,c){if(null!=I){I.style.height=c+"px";I.style.width=b+"px";I.style.padding="0px";c=c-(null!=Ve?Ve.offsetHeight:0)-(null!=We?We.offsetHeight:0)-(null!=ob?ob.offsetHeight:0)-Cg*(null!=xb?xb.offsetHeight:0);c>X&&(c=X);var a=c*ia/X;a>b&&(a=b,c=b*X/ia);c=Math.floor(c);
a=Math.floor(a);Qc||($a(a,c),U())}};this.drag=function(b){lb||(L=la.getX(),G=la.getY(),Yc?(b=r.length-1,r[b].xe=L,r[b].ye=G,r[b].xp.push(L),r[b].yp.push(G),r[b].size=Math.round(Math.sqrt(Math.pow(L-r[b].x,2)+Math.pow(G-r[b].y,2)))):(u=L*q,p=G*x,Dc=sb=!1,Xb&&(!Td||Td&&b.shiftKey)?(Id=u,Jd=p,Dc=!0):(sa&&S!=pe?(J=aa-u/P,E=ba-p/S,0>J&&(J=0),E<Zd&&(E=Zd),J+Oa>ia&&(J=ia-Oa),E+Aa>X-Pc&&(E=X-Pc-Aa),J=Math.round(J),E=Math.round(E),aa=Math.round(J+u/P),ba=Math.round(E+p/S)):lb||Ra||!Xa||(ka=null,Lc&&0<=u&&
0<=p&&(F=wd.getImageData(u,p,1,1).data,0!=F[3]&&(ka=Ea[F[3]-1]))),xe=!0,l())),U())};this.resetZoom=function(){P=ff;S=pe;null!=ta&&(H(ta,!0,"zoom on"),sa=!1);aa=u;ba=p;E=J=0;Aa=X;Oa=ia;pc();l();Sc&&(Xa=!0)};this.canTip=function(){var b;sb=!1;L=la.getX();u=L*q;G=la.getY();p=G*x;if(!((lb||Ra)&&p<Kg&&p>Jg&&u>Ig)){aa=Math.round(J+u/P);ba=Math.round(E+p/S);if(0!=ib)for(b=0;b<ib;b++)if(ya[b].overlay>=na)fa(" Error...hotzone overlay # "+ya[b].overlay+" > number of overlays = "+na);else if(z[ya[b].overlay].checked&&
(Ia.clearRect(0,0,1,1),Ia.drawImage(C[w][ya[b].overlay],aa,ba,1,1,0,0,1,1),F=Ia.getImageData(0,0,1,1).data,tf=(F[0]<<16)+(F[1]<<8)+F[2],tf==ya[b].color)){sb=!0;Lg=L;Mg=G;Ng=ya[b].tip;break}if(0!=kb)for(b=kb-1;0<=b;b--){var c=fc[b];if(-1==c.frame||c.frame==w)if(-1==c.overlay||z[c.overlay].checked){var a=!1;if(c.isPan)if(c.isIcon){var d=(c.x0-J)*P-c.w2;var e=(c.y0-E)*S-c.h2;u>d&&u<d+c.width&&p>e&&p<e+c.height&&(a=!0)}else d=(c.x0-J)*P,e=(c.y0-E)*S,u>d&&u<d+c.width*P&&p>e&&p<e+c.height*S&&(a=!0);else u>
c.x0&&u<c.x1&&p>c.y0&&p<c.y1&&(a=!0);if(a&&null!=c.tip){sb=!0;Lg=L;Mg=G;Ng=fc[b].tip;break}}}U()}};this.move=function(){if(!Ra&&Xa&&(ka=null,Lc)){var b=la.getX()*q,c=la.getY()*x;0<=b&&0<=c&&(F=wd.getImageData(b,c,1,1).data,0!=F[3]&&(ka=Ea[F[3]-1]))}Ra&&2<=Ha&&(L=la.getX(),u=L*q,G=la.getY(),p=G*x);U()};this.down=function(){sb&&(sb=!1,U());L=la.getX();u=L*q;G=la.getY();p=G*x;te=u;ue=p;Id=te;Jd=ue;aa=Math.round(J+u/P);ba=Math.round(E+p/S);xe=!1;if(Yc){var b={};b.x=L;b.y=G;b.xe=L;b.ye=G;b.xp=[L];b.yp=
[G];b.type=Dd.value;b.color=Cd.value;b.width=mc.value;b.text=wb.value;b.size=0;r.push(b)}};this.up=function(b){sb=!1;if(!Yc){if(Ra||lb){L=la.getX();u=L*q;G=la.getY();p=G*x;if(lb){Wc=1;if(0<Wc&&p/x<hh){if(u/q>gh){ja.pop();ja.pop();0==ja.length&&(Wc=0);U();return}if(u/q<fh){U();b=window.open("","Mark Points");b.document.write("<div>Marked Points<br>");for(var c=[],a=0;a<ja.length;a+=2)aa=J+ja[a]/P,ba=E+ja[a+1]/S,null!=Na?pa=Na.toLatLon(aa,ba):null!=ud?(pa[0]=ud+(hg-ud)*ba/X,pa[1]=be+(ig-be)*aa/ia):
(pa[0]=Math.round(aa),pa[1]=Math.round(ba)),b.document.write(pa[0].toFixed(4)+","+pa[1].toFixed(4)+"<br>"),0==a&&(c[0]=pa[0],c[1]=pa[1]);b.document.write(c[0].toFixed(4)+","+c[1].toFixed(4)+"<br>");return}}ja.push(u);ja.push(p);U();return}if(3>Ha)if(yb[Ha]=u,pb[Ha]=p,$c[Ha]=Qe[w],0==Ha)Ha=1,Ba(qa(v-1)),qe=1,Oc=null;else{Ug=$c[1]-$c[0];se=(yb[1]-yb[0])/Ug;Hd=(pb[1]-pb[0])/Ug;if(null!=Je&&null!=rc){a=se*rc;var d=Hd*Sd;c=Math.round(60*Math.sqrt(a*a+d*d));a=Math.atan2(a,-d)/.0174533;0>a&&(a+=360);Oc=
Of+ph[Math.round(a/22.5)]+" at "+c+" "+Pf;dh=yb[0];eh=0<Hd?pb[0]-15:pb[0]+30}c=parseInt(kd,10);R=Math.round(Math.abs(4*(c+4)/se));ad=Math.round(Math.abs(2*(c+4)/Hd));ad<R&&(R=ad);120<R?R=120*Math.floor(R/120)+60:90<R?R=120:60<R?R=90:30<R?R=60:15<R?R=30:10<R?R=15:5<R?R=10:2<R?R=5:0==R&&(R=1);ad=$c[1]/R*R+R;Gd=1;Nf&&(Gd=-1);Hg=se*R;of=Hd*R;Ba(qa(v-1));Ha=3;qe=2}else if(p/x<Kg&&p/x>Jg&&u/q>Ig&&3==Ha){qc();U();return}U()}if(Dc)Dc=!1,U();else if(null!=ub&&sa&&(Xb=!1,H(ub,!0,"distance on")),xe)xe=!1;else if(b.altKey)HAniS.resetZoom();
else if(Xa&&null!=ka&&nf)Bb(ka,"z");else{L=la.getX();u=L*q;G=la.getY();p=G*x;if(0!=ib)for(c=0;c<ib;c++)if(ya[c].overlay>=na)fa(" Error...hotzone overlay # "+ya[c].overlay+" > number of overlays = "+na);else if(z[ya[c].overlay].checked&&(Ia.clearRect(0,0,1,1),Ia.drawImage(C[w][ya[c].overlay],Math.floor(aa),Math.floor(ba),1,1,0,0,1,1),F=Ia.getImageData(0,0,1,1).data,tf=(F[0]<<16)+(F[1]<<8)+F[2],tf==ya[c].color)){Bb(ya[c],"z");return}if(0!=kb)for(c=kb-1;0<=c;c--){var e=fc[c];if(-1==e.frame||e.frame==
w)if(-1==e.overlay||z[e.overlay].checked){var g=!1;e.isPan?e.isIcon?(a=(e.x0-J)*P-e.w2,d=(e.y0-E)*S-e.h2,u>a&&u<a+e.width&&p>d&&p<d+e.height&&(g=!0)):(a=(e.x0-J)*P,d=(e.y0-E)*S,u>a&&u<a+e.width*P&&p>d&&p<d+e.height*S&&(g=!0)):u>e.x0&&u<e.x1&&p>e.y0&&p<e.y1&&(g=!0);if(g){Bb(fc[c],"s");return}}}sa&&(Xa=!1,Jc(b.ctrlKey||sf));l();U()}}};this.wheel=function(b){sa&&(L=la.getX(),u=L*q,G=la.getY(),p=G*x,aa=Math.round(J+u/P),ba=Math.round(E+p/S),Jc(-1==b))};this.toggleAutoRefresh=function(){fd?(H(dc,!1,"autorefresh off"),
null!=sc&&clearInterval(sc),fd=!1):(H(dc,!0,"autorefresh on"),sc=setInterval("HAniS.reloadFOF();",Ce),fd=!0)};this.toggleLoopRock=function(){Fd?(H(Tc,!0,"looprock rock"),Fd=!1):(H(Tc,!1,"looprock loop"),Fd=!0)};this.toggleExtrap=function(){Ra?(null!=tb&&(H(tb,!0,"extrap on"),I.style.cursor="default",null!=hb&&(hb.disabled=!1),ea(Pb),sa=Yf,Ha=-1),Ra=!1,U()):(null!=tb&&(Ra=!0,Oc=null,I.style.cursor="crosshair",H(tb,!1,"extrap off"),Pb=Ya,null!=hb&&(hb.disabled=!0),Ya=!1,Yf=sa,sa=!1,HAniS.resetZoom(),
qc(),U()),l())};this.doEnhance=function(b){if(Rc||vc){var c=Da[0].height,a=Da[0].width;b=parseInt(wa.value,10);0<=b&&(gf=Ka[b],hf=La[b],jf=Ma[b],kf=rd[b],uc[Zb]=b);var d=c*a*4;for(a=0;a<Mb.length;a++)if(Da[a].gotit){Da[a].gotit=!1;var e=fe[a].data;var g=Se[a];if(0>b)for(c=0;c<d;c+=4)e[c]=g[c],e[c+1]=g[c+1],e[c+2]=g[c+2],e[c+3]=g[c+3];else for(c=0;c<d;c+=4)Qa=g[c],Qa===g[c+1]&&Qa===g[c+2]&&(e[c]=gf[Qa],e[c+1]=hf[Qa],e[c+2]=jf[Qa],e[c+3]=kf[Qa]);Cc[a].putImageData(fe[a],0,0);Da[a].gotit=!0}}};this.overClick=
function(b){var c;if(b.target.checked)for(c=0;c<z.length;c++)b.target!=z[c]&&0!=b.target.name&&b.target.name==z[c].name&&(z[c].checked=!1);Lc=!0;for(c=0;c<Gb.length;c++)b.target!=z[c]&&ab(c),null!=$b&&!$b[c]&&z[c].checked&&(Lc=!1),null!=wa&&c==Zb&&(wa.disabled=!z[c].checked);l()};this.toggleIsLooping=function(){Ya?(Ya=!1,H(hb,!0,"startstop start")):(Ya=!0,H(hb,!1,"startstop stop"))};this.toggleZooming=function(){sa?(HAniS.resetZoom(),H(ta,!0,"zoom on")):(H(ta,!1,"zoom off"),sa=!0,null!=ub&&(Xb=!1,
H(ub,!0,"distance on")),Sc&&(Xa=!0),Ra&&HAniS.toggleExtrap())};this.togclick=function(b){var c=Bg.getX();Bg.getY();for(var a=Fg,d=0;d<Fa.length;d++){if(c>a&&c<a+Zc){if(b.shiftKey){0<=Fa[d]&&(ea(!1),Ba(d));break}b=0;0<=Fa[d]&&(b=-1);cb(d,b);break}a=a+Zc+ne}}};
